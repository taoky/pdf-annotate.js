{"version":3,"file":"index.js","mappings":"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","sources":["webpack://PDFAnnotate/webpack/universalModuleDefinition","webpack://PDFAnnotate/./node_modules/events/events.js","webpack://PDFAnnotate/webpack/bootstrap","webpack://PDFAnnotate/webpack/runtime/compat get default export","webpack://PDFAnnotate/webpack/runtime/define property getters","webpack://PDFAnnotate/webpack/runtime/hasOwnProperty shorthand","webpack://PDFAnnotate/webpack/runtime/make namespace object","webpack://PDFAnnotate/./src/utils/abstractFunction.js","webpack://PDFAnnotate/./src/utils/setAttributes.js","webpack://PDFAnnotate/./src/utils/normalizeColor.js","webpack://PDFAnnotate/./src/render/renderPoint.js","webpack://PDFAnnotate/./src/render/renderRect.js","webpack://PDFAnnotate/./src/render/renderText.js","webpack://PDFAnnotate/./src/utils/mathUtils.js","webpack://PDFAnnotate/./src/render/appendChild.js","webpack://PDFAnnotate/./src/render/renderLine.js","webpack://PDFAnnotate/./src/render/renderCircle.js","webpack://PDFAnnotate/./src/render/renderPath.js","webpack://PDFAnnotate/./src/render/renderArrow.js","webpack://PDFAnnotate/./src/UI/utils.js","webpack://PDFAnnotate/./src/UI/event.js","webpack://PDFAnnotate/./src/adapter/StoreAdapter.js","webpack://PDFAnnotate/./src/utils/uuid.js","webpack://PDFAnnotate/./src/adapter/LocalStoreAdapter.js","webpack://PDFAnnotate/./src/adapter/LocalUserStoreAdapter.js","webpack://PDFAnnotate/./src/config.js","webpack://PDFAnnotate/./src/UI/edit.js","webpack://PDFAnnotate/./src/UI/pen.js","webpack://PDFAnnotate/./src/UI/arrow.js","webpack://PDFAnnotate/./src/UI/eraser.js","webpack://PDFAnnotate/./src/UI/point.js","webpack://PDFAnnotate/./src/UI/rect.js","webpack://PDFAnnotate/./src/UI/circle.js","webpack://PDFAnnotate/./src/UI/text.js","webpack://PDFAnnotate/./src/a11y/createScreenReaderOnly.js","webpack://PDFAnnotate/./src/a11y/insertElementWithinElement.js","webpack://PDFAnnotate/./src/a11y/insertElementWithinChildren.js","webpack://PDFAnnotate/./src/a11y/insertScreenReaderComment.js","webpack://PDFAnnotate/./src/a11y/renderScreenReaderComments.js","webpack://PDFAnnotate/./src/a11y/insertScreenReaderHint.js","webpack://PDFAnnotate/./src/a11y/initEventHandlers.js","webpack://PDFAnnotate/./src/a11y/renderScreenReaderHints.js","webpack://PDFAnnotate/./src/UI/page.js","webpack://PDFAnnotate/./src/UI/index.js","webpack://PDFAnnotate/./src/PDFJSAnnotate.js","webpack://PDFAnnotate/./src/render/index.js","webpack://PDFAnnotate/./index.js","webpack://PDFAnnotate/./web/shared/initColorPicker.js","webpack://PDFAnnotate/./web/index.js"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"PDFAnnotate\"] = factory();\n\telse\n\t\troot[\"PDFAnnotate\"] = factory();\n})(self, () => {\nreturn ","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n'use strict';\n\nvar R = typeof Reflect === 'object' ? Reflect : null\nvar ReflectApply = R && typeof R.apply === 'function'\n  ? R.apply\n  : function ReflectApply(target, receiver, args) {\n    return Function.prototype.apply.call(target, receiver, args);\n  }\n\nvar ReflectOwnKeys\nif (R && typeof R.ownKeys === 'function') {\n  ReflectOwnKeys = R.ownKeys\n} else if (Object.getOwnPropertySymbols) {\n  ReflectOwnKeys = function ReflectOwnKeys(target) {\n    return Object.getOwnPropertyNames(target)\n      .concat(Object.getOwnPropertySymbols(target));\n  };\n} else {\n  ReflectOwnKeys = function ReflectOwnKeys(target) {\n    return Object.getOwnPropertyNames(target);\n  };\n}\n\nfunction ProcessEmitWarning(warning) {\n  if (console && console.warn) console.warn(warning);\n}\n\nvar NumberIsNaN = Number.isNaN || function NumberIsNaN(value) {\n  return value !== value;\n}\n\nfunction EventEmitter() {\n  EventEmitter.init.call(this);\n}\nmodule.exports = EventEmitter;\nmodule.exports.once = once;\n\n// Backwards-compat with node 0.10.x\nEventEmitter.EventEmitter = EventEmitter;\n\nEventEmitter.prototype._events = undefined;\nEventEmitter.prototype._eventsCount = 0;\nEventEmitter.prototype._maxListeners = undefined;\n\n// By default EventEmitters will print a warning if more than 10 listeners are\n// added to it. This is a useful default which helps finding memory leaks.\nvar defaultMaxListeners = 10;\n\nfunction checkListener(listener) {\n  if (typeof listener !== 'function') {\n    throw new TypeError('The \"listener\" argument must be of type Function. Received type ' + typeof listener);\n  }\n}\n\nObject.defineProperty(EventEmitter, 'defaultMaxListeners', {\n  enumerable: true,\n  get: function() {\n    return defaultMaxListeners;\n  },\n  set: function(arg) {\n    if (typeof arg !== 'number' || arg < 0 || NumberIsNaN(arg)) {\n      throw new RangeError('The value of \"defaultMaxListeners\" is out of range. It must be a non-negative number. Received ' + arg + '.');\n    }\n    defaultMaxListeners = arg;\n  }\n});\n\nEventEmitter.init = function() {\n\n  if (this._events === undefined ||\n      this._events === Object.getPrototypeOf(this)._events) {\n    this._events = Object.create(null);\n    this._eventsCount = 0;\n  }\n\n  this._maxListeners = this._maxListeners || undefined;\n};\n\n// Obviously not all Emitters should be limited to 10. This function allows\n// that to be increased. Set to zero for unlimited.\nEventEmitter.prototype.setMaxListeners = function setMaxListeners(n) {\n  if (typeof n !== 'number' || n < 0 || NumberIsNaN(n)) {\n    throw new RangeError('The value of \"n\" is out of range. It must be a non-negative number. Received ' + n + '.');\n  }\n  this._maxListeners = n;\n  return this;\n};\n\nfunction _getMaxListeners(that) {\n  if (that._maxListeners === undefined)\n    return EventEmitter.defaultMaxListeners;\n  return that._maxListeners;\n}\n\nEventEmitter.prototype.getMaxListeners = function getMaxListeners() {\n  return _getMaxListeners(this);\n};\n\nEventEmitter.prototype.emit = function emit(type) {\n  var args = [];\n  for (var i = 1; i < arguments.length; i++) args.push(arguments[i]);\n  var doError = (type === 'error');\n\n  var events = this._events;\n  if (events !== undefined)\n    doError = (doError && events.error === undefined);\n  else if (!doError)\n    return false;\n\n  // If there is no 'error' event listener then throw.\n  if (doError) {\n    var er;\n    if (args.length > 0)\n      er = args[0];\n    if (er instanceof Error) {\n      // Note: The comments on the `throw` lines are intentional, they show\n      // up in Node's output if this results in an unhandled exception.\n      throw er; // Unhandled 'error' event\n    }\n    // At least give some kind of context to the user\n    var err = new Error('Unhandled error.' + (er ? ' (' + er.message + ')' : ''));\n    err.context = er;\n    throw err; // Unhandled 'error' event\n  }\n\n  var handler = events[type];\n\n  if (handler === undefined)\n    return false;\n\n  if (typeof handler === 'function') {\n    ReflectApply(handler, this, args);\n  } else {\n    var len = handler.length;\n    var listeners = arrayClone(handler, len);\n    for (var i = 0; i < len; ++i)\n      ReflectApply(listeners[i], this, args);\n  }\n\n  return true;\n};\n\nfunction _addListener(target, type, listener, prepend) {\n  var m;\n  var events;\n  var existing;\n\n  checkListener(listener);\n\n  events = target._events;\n  if (events === undefined) {\n    events = target._events = Object.create(null);\n    target._eventsCount = 0;\n  } else {\n    // To avoid recursion in the case that type === \"newListener\"! Before\n    // adding it to the listeners, first emit \"newListener\".\n    if (events.newListener !== undefined) {\n      target.emit('newListener', type,\n                  listener.listener ? listener.listener : listener);\n\n      // Re-assign `events` because a newListener handler could have caused the\n      // this._events to be assigned to a new object\n      events = target._events;\n    }\n    existing = events[type];\n  }\n\n  if (existing === undefined) {\n    // Optimize the case of one listener. Don't need the extra array object.\n    existing = events[type] = listener;\n    ++target._eventsCount;\n  } else {\n    if (typeof existing === 'function') {\n      // Adding the second element, need to change to array.\n      existing = events[type] =\n        prepend ? [listener, existing] : [existing, listener];\n      // If we've already got an array, just append.\n    } else if (prepend) {\n      existing.unshift(listener);\n    } else {\n      existing.push(listener);\n    }\n\n    // Check for listener leak\n    m = _getMaxListeners(target);\n    if (m > 0 && existing.length > m && !existing.warned) {\n      existing.warned = true;\n      // No error code for this since it is a Warning\n      // eslint-disable-next-line no-restricted-syntax\n      var w = new Error('Possible EventEmitter memory leak detected. ' +\n                          existing.length + ' ' + String(type) + ' listeners ' +\n                          'added. Use emitter.setMaxListeners() to ' +\n                          'increase limit');\n      w.name = 'MaxListenersExceededWarning';\n      w.emitter = target;\n      w.type = type;\n      w.count = existing.length;\n      ProcessEmitWarning(w);\n    }\n  }\n\n  return target;\n}\n\nEventEmitter.prototype.addListener = function addListener(type, listener) {\n  return _addListener(this, type, listener, false);\n};\n\nEventEmitter.prototype.on = EventEmitter.prototype.addListener;\n\nEventEmitter.prototype.prependListener =\n    function prependListener(type, listener) {\n      return _addListener(this, type, listener, true);\n    };\n\nfunction onceWrapper() {\n  if (!this.fired) {\n    this.target.removeListener(this.type, this.wrapFn);\n    this.fired = true;\n    if (arguments.length === 0)\n      return this.listener.call(this.target);\n    return this.listener.apply(this.target, arguments);\n  }\n}\n\nfunction _onceWrap(target, type, listener) {\n  var state = { fired: false, wrapFn: undefined, target: target, type: type, listener: listener };\n  var wrapped = onceWrapper.bind(state);\n  wrapped.listener = listener;\n  state.wrapFn = wrapped;\n  return wrapped;\n}\n\nEventEmitter.prototype.once = function once(type, listener) {\n  checkListener(listener);\n  this.on(type, _onceWrap(this, type, listener));\n  return this;\n};\n\nEventEmitter.prototype.prependOnceListener =\n    function prependOnceListener(type, listener) {\n      checkListener(listener);\n      this.prependListener(type, _onceWrap(this, type, listener));\n      return this;\n    };\n\n// Emits a 'removeListener' event if and only if the listener was removed.\nEventEmitter.prototype.removeListener =\n    function removeListener(type, listener) {\n      var list, events, position, i, originalListener;\n\n      checkListener(listener);\n\n      events = this._events;\n      if (events === undefined)\n        return this;\n\n      list = events[type];\n      if (list === undefined)\n        return this;\n\n      if (list === listener || list.listener === listener) {\n        if (--this._eventsCount === 0)\n          this._events = Object.create(null);\n        else {\n          delete events[type];\n          if (events.removeListener)\n            this.emit('removeListener', type, list.listener || listener);\n        }\n      } else if (typeof list !== 'function') {\n        position = -1;\n\n        for (i = list.length - 1; i >= 0; i--) {\n          if (list[i] === listener || list[i].listener === listener) {\n            originalListener = list[i].listener;\n            position = i;\n            break;\n          }\n        }\n\n        if (position < 0)\n          return this;\n\n        if (position === 0)\n          list.shift();\n        else {\n          spliceOne(list, position);\n        }\n\n        if (list.length === 1)\n          events[type] = list[0];\n\n        if (events.removeListener !== undefined)\n          this.emit('removeListener', type, originalListener || listener);\n      }\n\n      return this;\n    };\n\nEventEmitter.prototype.off = EventEmitter.prototype.removeListener;\n\nEventEmitter.prototype.removeAllListeners =\n    function removeAllListeners(type) {\n      var listeners, events, i;\n\n      events = this._events;\n      if (events === undefined)\n        return this;\n\n      // not listening for removeListener, no need to emit\n      if (events.removeListener === undefined) {\n        if (arguments.length === 0) {\n          this._events = Object.create(null);\n          this._eventsCount = 0;\n        } else if (events[type] !== undefined) {\n          if (--this._eventsCount === 0)\n            this._events = Object.create(null);\n          else\n            delete events[type];\n        }\n        return this;\n      }\n\n      // emit removeListener for all listeners on all events\n      if (arguments.length === 0) {\n        var keys = Object.keys(events);\n        var key;\n        for (i = 0; i < keys.length; ++i) {\n          key = keys[i];\n          if (key === 'removeListener') continue;\n          this.removeAllListeners(key);\n        }\n        this.removeAllListeners('removeListener');\n        this._events = Object.create(null);\n        this._eventsCount = 0;\n        return this;\n      }\n\n      listeners = events[type];\n\n      if (typeof listeners === 'function') {\n        this.removeListener(type, listeners);\n      } else if (listeners !== undefined) {\n        // LIFO order\n        for (i = listeners.length - 1; i >= 0; i--) {\n          this.removeListener(type, listeners[i]);\n        }\n      }\n\n      return this;\n    };\n\nfunction _listeners(target, type, unwrap) {\n  var events = target._events;\n\n  if (events === undefined)\n    return [];\n\n  var evlistener = events[type];\n  if (evlistener === undefined)\n    return [];\n\n  if (typeof evlistener === 'function')\n    return unwrap ? [evlistener.listener || evlistener] : [evlistener];\n\n  return unwrap ?\n    unwrapListeners(evlistener) : arrayClone(evlistener, evlistener.length);\n}\n\nEventEmitter.prototype.listeners = function listeners(type) {\n  return _listeners(this, type, true);\n};\n\nEventEmitter.prototype.rawListeners = function rawListeners(type) {\n  return _listeners(this, type, false);\n};\n\nEventEmitter.listenerCount = function(emitter, type) {\n  if (typeof emitter.listenerCount === 'function') {\n    return emitter.listenerCount(type);\n  } else {\n    return listenerCount.call(emitter, type);\n  }\n};\n\nEventEmitter.prototype.listenerCount = listenerCount;\nfunction listenerCount(type) {\n  var events = this._events;\n\n  if (events !== undefined) {\n    var evlistener = events[type];\n\n    if (typeof evlistener === 'function') {\n      return 1;\n    } else if (evlistener !== undefined) {\n      return evlistener.length;\n    }\n  }\n\n  return 0;\n}\n\nEventEmitter.prototype.eventNames = function eventNames() {\n  return this._eventsCount > 0 ? ReflectOwnKeys(this._events) : [];\n};\n\nfunction arrayClone(arr, n) {\n  var copy = new Array(n);\n  for (var i = 0; i < n; ++i)\n    copy[i] = arr[i];\n  return copy;\n}\n\nfunction spliceOne(list, index) {\n  for (; index + 1 < list.length; index++)\n    list[index] = list[index + 1];\n  list.pop();\n}\n\nfunction unwrapListeners(arr) {\n  var ret = new Array(arr.length);\n  for (var i = 0; i < ret.length; ++i) {\n    ret[i] = arr[i].listener || arr[i];\n  }\n  return ret;\n}\n\nfunction once(emitter, name) {\n  return new Promise(function (resolve, reject) {\n    function errorListener(err) {\n      emitter.removeListener(name, resolver);\n      reject(err);\n    }\n\n    function resolver() {\n      if (typeof emitter.removeListener === 'function') {\n        emitter.removeListener('error', errorListener);\n      }\n      resolve([].slice.call(arguments));\n    };\n\n    eventTargetAgnosticAddListener(emitter, name, resolver, { once: true });\n    if (name !== 'error') {\n      addErrorHandlerIfEventEmitter(emitter, errorListener, { once: true });\n    }\n  });\n}\n\nfunction addErrorHandlerIfEventEmitter(emitter, handler, flags) {\n  if (typeof emitter.on === 'function') {\n    eventTargetAgnosticAddListener(emitter, 'error', handler, flags);\n  }\n}\n\nfunction eventTargetAgnosticAddListener(emitter, name, listener, flags) {\n  if (typeof emitter.on === 'function') {\n    if (flags.once) {\n      emitter.once(name, listener);\n    } else {\n      emitter.on(name, listener);\n    }\n  } else if (typeof emitter.addEventListener === 'function') {\n    // EventTarget does not have `error` event semantics like Node\n    // EventEmitters, we do not listen for `error` events here.\n    emitter.addEventListener(name, function wrapListener(arg) {\n      // IE does not have builtin `{ once: true }` support so we\n      // have to do it manually.\n      if (flags.once) {\n        emitter.removeEventListener(name, wrapListener);\n      }\n      listener(arg);\n    });\n  } else {\n    throw new TypeError('The \"emitter\" argument must be of type EventEmitter. Received type ' + typeof emitter);\n  }\n}\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","/**\n * Throw an Error for an abstract function that hasn't been implemented.\n *\n * @param {String} name The name of the abstract function\n */\nexport default function abstractFunction(name) {\n  throw new Error(name + ' is not implemented');\n}\n","const UPPER_REGEX = /[A-Z]/g;\n\n// Don't convert these attributes from camelCase to hyphenated-attributes\nconst BLACKLIST = [\n  'viewBox'\n];\n\nlet keyCase = (key) => {\n  if (BLACKLIST.indexOf(key) === -1) {\n    key = key.replace(UPPER_REGEX, match => '-' + match.toLowerCase());\n  }\n  return key;\n};\n\n/**\n * Set attributes for a node from a map\n *\n * @param {Node} node The node to set attributes on\n * @param {Object} attributes The map of key/value pairs to use for attributes\n */\nexport default function setAttributes(node, attributes) {\n  Object.keys(attributes).forEach((key) => {\n    node.setAttribute(keyCase(key), attributes[key]);\n  });\n}\n","const REGEX_HASHLESS_HEX = /^([a-f0-9]{6}|[a-f0-9]{3})$/i;\n\n/**\n * Normalize a color value\n *\n * @param {String} color The color to normalize\n * @return {String} Normalized color\n */\nexport default function normalizeColor(color) {\n  if (REGEX_HASHLESS_HEX.test(color)) {\n    color = `#${color}`;\n  }\n  return color;\n}\n","import setAttributes from '../utils/setAttributes';\n\nconst SIZE = 25;\nconst D = 'M499.968 214.336q-113.832 0 -212.877 38.781t-157.356 104.625 -58.311 142.29q0 62.496 39.897 119.133t112.437 97.929l48.546 27.9 -15.066 53.568q-13.392 50.778 -39.06 95.976 84.816 -35.154 153.45 -95.418l23.994 -21.204 31.806 3.348q38.502 4.464 72.54 4.464 113.832 0 212.877 -38.781t157.356 -104.625 58.311 -142.29 -58.311 -142.29 -157.356 -104.625 -212.877 -38.781z';\n\n/**\n * Create SVGElement from an annotation definition.\n * This is used for anntations of type `comment`.\n *\n * @param {Object} a The annotation definition\n * @return {SVGElement} A svg to be rendered\n */\nexport default function renderPoint(a) {\n  let outerSVG = document.createElementNS('http://www.w3.org/2000/svg', 'svg');\n  let innerSVG = document.createElementNS('http://www.w3.org/2000/svg', 'svg');\n  let rect = document.createElementNS('http://www.w3.org/2000/svg', 'rect');\n  let path = document.createElementNS('http://www.w3.org/2000/svg', 'path');\n\n  setAttributes(outerSVG, {\n    width: SIZE,\n    height: SIZE,\n    x: a.x,\n    y: a.y\n  });\n\n  setAttributes(innerSVG, {\n    width: SIZE,\n    height: SIZE,\n    x: 0,\n    y: (SIZE * 0.05) * -1,\n    viewBox: '0 0 1000 1000'\n  });\n\n  setAttributes(rect, {\n    width: SIZE,\n    height: SIZE,\n    stroke: '#000',\n    fill: '#ff0'\n  });\n\n  setAttributes(path, {\n    d: D,\n    strokeWidth: 50,\n    stroke: '#000',\n    fill: '#fff'\n  });\n\n  innerSVG.appendChild(path);\n  outerSVG.appendChild(rect);\n  outerSVG.appendChild(innerSVG);\n\n  return outerSVG;\n}\n","import setAttributes from '../utils/setAttributes';\nimport normalizeColor from '../utils/normalizeColor';\n\n/**\n * Create SVGRectElements from an annotation definition.\n * This is used for anntations of type `area` and `highlight`.\n *\n * @param {Object} a The annotation definition\n * @return {SVGGElement|SVGRectElement} A group of all rects to be rendered\n */\nexport default function renderRect(a) {\n  if (a.type === 'highlight') {\n    let group = document.createElementNS('http://www.w3.org/2000/svg', 'g');\n    setAttributes(group, {\n      fill: normalizeColor(a.color || '#ff0'),\n      fillOpacity: 0.2\n    });\n\n    a.rectangles.forEach((r) => {\n      group.appendChild(createRect(r));\n    });\n\n    return group;\n  }\n  else {\n    let rect = createRect(a);\n    setAttributes(rect, {\n      stroke: normalizeColor(a.color || '#f00'),\n      fill: 'none'\n    });\n\n    return rect;\n  }\n}\n\nfunction createRect(r) {\n  let rect = document.createElementNS('http://www.w3.org/2000/svg', 'rect');\n\n  setAttributes(rect, {\n    x: r.x,\n    y: r.y,\n    width: r.width,\n    height: r.height\n  });\n\n  return rect;\n}\n","import setAttributes from '../utils/setAttributes';\nimport normalizeColor from '../utils/normalizeColor';\n\n/**\n * Wrap each line of given text in a `<tspan>` element and append these\n * lines to the given SVGTextElement\n *\n * @param {SVGTextElement} textElement A text element to hold the split text\n * @param {String} textContent String to render with line breaks\n */\nfunction insertLineBreaks(textElement, textContent) {\n  const lines = (textContent || '').split('\\n');\n  // can't use dy attribute here since we want empty lines to take up space as well,\n  // so we will update y manually based on font size\n  const x = textElement.getAttribute('x');\n  let y = Number(textElement.getAttribute('y'));\n  const size = Number(textElement.getAttribute('font-size'));\n  for (const line of lines) {\n    const tspan = document.createElementNS('http://www.w3.org/2000/svg', 'tspan');\n    tspan.setAttribute('y', y.toString());\n    tspan.setAttribute('x', x);\n    tspan.innerHTML = line;\n    textElement.appendChild(tspan);\n\n    y += size;\n  }\n}\n\n/**\n * Create SVGTextElement from an annotation definition.\n * This is used for anntations of type `textbox`.\n *\n * @param {Object} a The annotation definition\n * @return {SVGTextElement} A text to be rendered\n */\nexport default function renderText(a) {\n  // Text should be rendered at 0 degrees relative to\n  // document rotation\n  let text = document.createElementNS('http://www.w3.org/2000/svg', 'text');\n  setAttributes(text, {\n    x: a.x,\n    y: a.y,\n    fill: normalizeColor(a.color || '#000'),\n    fontSize: a.size,\n    transform: `rotate(${a.rotation})`,\n    style: 'white-space: pre'\n  });\n\n  insertLineBreaks(text, a.content);\n\n  let g = document.createElementNS('http://www.w3.org/2000/svg', 'g');\n  g.appendChild(text);\n\n  return g;\n}\n","// Transform point by matrix\n//\nexport function applyTransform(p, m) {\n  return [\n    p[0] * m[0] + p[1] * m[2] + m[4],\n    p[0] * m[1] + p[1] * m[3] + m[5]\n  ];\n};\n\n// Transform point by matrix inverse\n//\nexport function applyInverseTransform(p, m) {\n  let d = m[0] * m[3] - m[1] * m[2];\n  return [\n    (p[0] * m[3] - p[1] * m[2] + m[2] * m[5] - m[4] * m[3]) / d,\n    (-p[0] * m[1] + p[1] * m[0] + m[4] * m[1] - m[5] * m[0]) / d\n  ];\n};\n\n// Concatenates two transformation matrices together and returns the result.\nexport function transform(m1, m2) {\n  return [\n    m1[0] * m2[0] + m1[2] * m2[1],\n    m1[1] * m2[0] + m1[3] * m2[1],\n    m1[0] * m2[2] + m1[2] * m2[3],\n    m1[1] * m2[2] + m1[3] * m2[3],\n    m1[0] * m2[4] + m1[2] * m2[5] + m1[4],\n    m1[1] * m2[4] + m1[3] * m2[5] + m1[5]\n  ];\n};\n\nexport function translate(m, x, y) {\n  return [\n    m[0],\n    m[1],\n    m[2],\n    m[3],\n    m[0] * x + m[2] * y + m[4],\n    m[1] * x + m[3] * y + m[5]\n  ];\n};\n\nexport function rotate(m, angle) {\n  angle = angle * Math.PI / 180;\n\n  let cosValue = Math.cos(angle);\n  let sinValue = Math.sin(angle);\n\n  return [\n    m[0] * cosValue + m[2] * sinValue,\n    m[1] * cosValue + m[3] * sinValue,\n    m[0] * (-sinValue) + m[2] * cosValue,\n    m[1] * (-sinValue) + m[3] * cosValue,\n    m[4],\n    m[5]\n  ];\n};\n\nexport function scale(m, x, y) {\n  return [\n    m[0] * x,\n    m[1] * x,\n    m[2] * y,\n    m[3] * y,\n    m[4],\n    m[5]\n  ];\n};\n\nexport function makePoint(x, y, z) {\n  return { x: x, y: y, z: z };\n};\n\nexport function makeVector(xcoord, ycoord, zcoord) {\n  return { xcoord: xcoord, ycoord: ycoord, zcoord: zcoord };\n};\n\nexport function makeVectorFromPoints(pt1, pt2) {\n  let xcoord = pt2.x - pt1.x;\n  let ycoord = pt2.y - pt1.y;\n  let zcoord = pt2.z - pt1.z;\n  return makeVector(xcoord, ycoord, zcoord);\n};\n\nexport function addVector(pt, v) {\n  return makePoint(pt.x + v.xcoord, pt.y + v.ycoord, pt.z + v.zcoord);\n};\n\nexport function multiplyVector(v, scalar) {\n  return makeVector(v.xcoord * scalar, v.ycoord * scalar, v.zcoord * scalar);\n};\n\nexport function magnitude(v) {\n  return Math.sqrt(\n    Math.pow(v.xcoord, 2) + Math.pow(v.ycoord, 2) + Math.pow(v.zcoord, 2)\n  );\n};\n\nexport function negateVector(v) {\n  return multiplyVector(v, -1);\n};\n\nexport function unitVector(v) {\n  let mag = magnitude(v);\n  let xcoord = v.xcoord / mag;\n  let ycoord = v.ycoord / mag;\n  let zcoord = v.zcoord / mag;\n  return makeVector(xcoord, ycoord, zcoord);\n};\n\nexport function crossProduct(u, v) {\n  //\n  // u X v = < u2*v3 - u3*v2,\n  //           u3*v1 - u1*v3,\n  //           u1*v2 - u2*v1 >\n  let xcoord = u.ycoord * v.zcoord - u.zcoord * v.ycoord;\n  let ycoord = u.zcoord * v.xcoord - u.xcoord * v.zcoord;\n  let zcoord = u.xcoord * v.ycoord - u.ycoord * v.xcoord;\n  return makeVector(xcoord, ycoord, zcoord);\n};\n","import renderLine from './renderLine';\nimport renderPath from './renderPath';\nimport renderPoint from './renderPoint';\nimport renderRect from './renderRect';\nimport renderText from './renderText';\nimport renderCircle from './renderCircle';\nimport renderArrow from './renderArrow';\n\nconst isFirefox = /firefox/i.test(navigator.userAgent);\n\n/**\n * Get the x/y translation to be used for transforming the annotations\n * based on the rotation of the viewport.\n *\n * @param {Object} viewport The viewport data from the page\n * @return {Object} The coordinate after rotation (translation)\n */\nexport function getTranslation(viewport) {\n  let x;\n  let y;\n\n  // Modulus 360 on the rotation so that we only\n  // have to worry about four possible values.\n  switch (viewport.rotation % 360) {\n    case 0:\n      x = y = 0;\n      break;\n    case 90:\n      x = 0;\n      y = (viewport.width / viewport.scale) * -1;\n      break;\n    case 180:\n      x = (viewport.width / viewport.scale) * -1;\n      y = (viewport.height / viewport.scale) * -1;\n      break;\n    case 270:\n      x = (viewport.height / viewport.scale) * -1;\n      y = 0;\n      break;\n  }\n\n  return { x, y };\n}\n\n/**\n * Transform the rotation and scale of a node using SVG's native transform attribute.\n *\n * @param {Node} node The node to be transformed\n * @param {Object} viewport The page's viewport data\n * @return {Node} The node after transformation\n */\nfunction transform(node, viewport) {\n  let trans = getTranslation(viewport);\n\n  // Let SVG natively transform the element\n  node.setAttribute('transform', `scale(${viewport.scale}) rotate(${viewport.rotation}) translate(${trans.x}, ${trans.y})`);\n\n  // Manually adjust x/y for nested SVG nodes\n  if (!isFirefox && node.nodeName.toLowerCase() === 'svg') {\n    node.setAttribute('x', parseInt(node.getAttribute('x'), 10) * viewport.scale);\n    node.setAttribute('y', parseInt(node.getAttribute('y'), 10) * viewport.scale);\n\n    let x = parseInt(node.getAttribute('x', 10));\n    let y = parseInt(node.getAttribute('y', 10));\n    let width = parseInt(node.getAttribute('width'), 10);\n    let height = parseInt(node.getAttribute('height'), 10);\n    let path = node.querySelector('path');\n    let svg = path.parentNode;\n\n    // Scale width/height\n    [node, svg, path, node.querySelector('rect')].forEach((n) => {\n      n.setAttribute('width', parseInt(n.getAttribute('width'), 10) * viewport.scale);\n      n.setAttribute('height', parseInt(n.getAttribute('height'), 10) * viewport.scale);\n    });\n\n    // Transform path but keep scale at 100% since it will be handled natively\n    transform(path, Object.assign({}, viewport, { scale: 1 }));\n\n    switch (viewport.rotation % 360) {\n      case 90:\n        node.setAttribute('x', viewport.width - y - width);\n        node.setAttribute('y', x);\n        svg.setAttribute('x', 1);\n        svg.setAttribute('y', 0);\n        break;\n      case 180:\n        node.setAttribute('x', viewport.width - x - width);\n        node.setAttribute('y', viewport.height - y - height);\n        svg.setAttribute('y', 2);\n        break;\n      case 270:\n        node.setAttribute('x', y);\n        node.setAttribute('y', viewport.height - x - height);\n        svg.setAttribute('x', -1);\n        svg.setAttribute('y', 0);\n        break;\n    }\n  }\n\n  return node;\n}\n\n/**\n * Append an annotation as a child of an SVG.\n *\n * @param {SVGElement} svg The SVG element to append the annotation to\n * @param {Object} annotation The annotation definition to render and append\n * @param {Object} viewport The page's viewport data\n * @return {SVGElement} A node that was created and appended by this function\n */\nexport function appendChild(svg, annotation, viewport) {\n  if (!viewport) {\n    viewport = JSON.parse(svg.getAttribute('data-pdf-annotate-viewport'));\n  }\n\n  let child;\n  switch (annotation.type) {\n    case 'area':\n    case 'highlight':\n      child = renderRect(annotation);\n      break;\n    case 'circle':\n    case 'fillcircle':\n    case 'emptycircle':\n      child = renderCircle(annotation);\n      break;\n    case 'strikeout':\n      child = renderLine(annotation);\n      break;\n    case 'point':\n      child = renderPoint(annotation);\n      break;\n    case 'textbox':\n      child = renderText(annotation);\n      break;\n    case 'drawing':\n      child = renderPath(annotation);\n      break;\n    case 'arrow':\n      child = renderArrow(annotation);\n      break;\n  }\n\n  // If no type was provided for an annotation it will result in node being null.\n  // Skip appending/transforming if node doesn't exist.\n  if (child) {\n    // Set attributes\n    child.setAttribute('data-pdf-annotate-id', annotation.uuid);\n    child.setAttribute('aria-hidden', true);\n\n    // Dynamically set any other attributes associated with annotation that is not related to drawing it\n    Object.keys(annotation).filter((key) => {\n      return ['color', 'x', 'y', 'cx', 'cy', 'color', 'documentId', 'lines', 'page',\n        'width', 'class', 'content', 'size', 'rotation', 'r'].indexOf(key) === -1;\n    }).forEach((key) => {\n      child.setAttribute(`data-pdf-annotate-${key}`, annotation[key]);\n    });\n\n    svg.appendChild(transform(child, viewport));\n  }\n\n  return child;\n}\n\n/**\n * Transform a child annotation of an SVG.\n *\n * @param {SVGElement} svg The SVG element with the child annotation\n * @param {Object} child The SVG child to transform\n * @param {Object} viewport The page's viewport data\n * @return {SVGElement} A node that was transformed by this function\n */\nexport function transformChild(svg, child, viewport) {\n  if (!viewport) {\n    viewport = JSON.parse(svg.getAttribute('data-pdf-annotate-viewport'));\n  }\n\n  // If no type was provided for an annotation it will result in node being null.\n  // Skip transforming if node doesn't exist.\n  if (child) {\n    child = transform(child, viewport);\n  }\n\n  return child;\n}\n\nexport default {\n  /**\n   * Get the x/y translation to be used for transforming the annotations\n   * based on the rotation of the viewport.\n   */\n  getTranslation,\n\n  /**\n   * Append an SVG child for an annotation\n   */\n  appendChild,\n\n  /**\n   * Transform an existing SVG child\n   */\n  transformChild\n};\n","import setAttributes from '../utils/setAttributes';\nimport normalizeColor from '../utils/normalizeColor';\n\n/**\n * Create SVGLineElements from an annotation definition.\n * This is used for anntations of type `strikeout`.\n *\n * @param {Object} a The annotation definition\n * @return {SVGGElement} A group of all lines to be rendered\n */\nexport default function renderLine(a) {\n  let group = document.createElementNS('http://www.w3.org/2000/svg', 'g');\n  setAttributes(group, {\n    stroke: normalizeColor(a.color || '#f00'),\n    strokeWidth: 1\n  });\n\n  a.rectangles.forEach((r) => {\n    let line = document.createElementNS('http://www.w3.org/2000/svg', 'line');\n\n    setAttributes(line, {\n      x1: r.x,\n      y1: r.y,\n      x2: r.x + r.width,\n      y2: r.y\n    });\n\n    group.appendChild(line);\n  });\n\n  return group;\n}\n","import setAttributes from '../utils/setAttributes';\nimport normalizeColor from '../utils/normalizeColor';\n\n/**\n * Create an SVGCircleElement from an annotation definition.\n * This is used for annotations of type `circle`.\n *\n * @param {Object} a The annotation definition\n * @return {SVGGElement|SVGCircleElement} A circle to be rendered\n */\nexport default function renderCircle(a) {\n  let circle = createCircle(a);\n  let color = normalizeColor(a.color || '#f00');\n\n  if (a.type === 'circle') {\n    setAttributes(circle, {\n      stroke: color,\n      fill: 'none',\n      'stroke-width': 5\n    });\n  }\n  if (a.type === 'emptycircle') {\n    setAttributes(circle, {\n      stroke: color,\n      fill: 'none',\n      'stroke-width': 2\n    });\n  }\n\n  if (a.type === 'fillcircle') {\n    setAttributes(circle, {\n      stroke: color,\n      fill: color,\n      'stroke-width': 5\n    });\n  }\n\n  return circle;\n}\n\nfunction createCircle(a) {\n  let circle = document.createElementNS('http://www.w3.org/2000/svg', 'circle');\n  setAttributes(circle, {\n    cx: a.cx,\n    cy: a.cy,\n    r: a.r\n  });\n\n  return circle;\n}\n","import setAttributes from '../utils/setAttributes';\nimport normalizeColor from '../utils/normalizeColor';\n\n/**\n * Create SVGPathElement from an annotation definition.\n * This is used for anntations of type `drawing`.\n *\n * @param {Object} a The annotation definition\n * @return {SVGPathElement} The path to be rendered\n */\nexport default function renderPath(a) {\n  let d = [];\n  let path = document.createElementNS('http://www.w3.org/2000/svg', 'path');\n\n  if (a.lines.length > 0) {\n    d.push(`M${a.lines[0][0]} ${a.lines[0][1]}`);\n    for (let i = 1, l = a.lines.length; i < l; i++) {\n      let p1 = a.lines[i];\n      let p2 = a.lines[i + 1];\n      if (p2) {\n        d.push(`L${p1[0]} ${p1[1]}`);\n      }\n    }\n  }\n\n  /*\n\n   if(a.lines.length>2) {\n    var p1 = a.lines[0];\n    var p2 = a.lines[a.lines.length-1];\n\n    var p3 = []; //arrow\n    var p4 = [];\n    var p0 = []; //arrow intersection\n\n    if (p2) {\n      var k = -(p2[0]-p1[0])/(p2[1]-p1[1]);\n\n      var deltaX = 3;\n      p0[0] = p1[0]+0.8*(p2[0]-p1[0]);\n      p0[1] = p1[1]+0.8*(p2[1]-p1[1]);\n\n      p3[0] = p0[0] + deltaX;\n      p3[1] = p0[1] + k*deltaX;\n\n      p4[0] = p0[0] - deltaX;\n      p4[1] = p0[1] - k*deltaX;\n\n      if(Math.abs(p2[1]-p1[1]) < 20) {\n\n        p3[0] = p0[0] ;\n        p3[1] = p0[1] + deltaX*1;\n\n        p4[0] = p0[0] ;\n        p4[1] = p0[1] - deltaX*1;\n\n      }\n\n      d.push(`M${p1[0]} ${p1[1]} ${p2[0]} ${p2[1]}`);\n       //d.push(`M${p1[0]} ${p1[1]} ${p2[0]} ${p2[1]}`);\n      d.push(`M${p2[0]} ${p2[1]} ${p3[0]} ${p3[1]}`);\n      d.push(`M${p3[0]} ${p3[1]} ${p4[0]} ${p4[1]}`);\n      d.push(`M${p4[0]} ${p4[1]} ${p2[0]} ${p2[1]}`);\n     }\n    } */\n\n  setAttributes(path, {\n    d: `${d.join(' ')}`, // `${d.join(' ')}Z`,\n    stroke: normalizeColor(a.color || '#000'),\n    strokeWidth: a.width || 1,\n    fill: 'none'\n  });\n\n  return path;\n}\n","import setAttributes from '../utils/setAttributes';\nimport normalizeColor from '../utils/normalizeColor';\nimport {\n  makePoint, makeVector, makeVectorFromPoints,\n  magnitude, unitVector, crossProduct,\n  addVector, multiplyVector, negateVector\n} from '../utils/mathUtils';\n\n/**\n * Create SVGPathElement from an annotation definition.\n * This is used for anntations of type `drawing`.\n *\n * @param {Object} a The annotation definition\n * @return {SVGPathElement} The path to be rendered\n */\nexport default function renderArrow(a) {\n  let arrow = document.createElementNS('http://www.w3.org/2000/svg', 'polygon');\n\n  if (a.lines.length === 2) {\n    let p1 = a.lines[0];\n    let p2 = a.lines[a.lines.length - 1];\n\n    let arrowLength = 40;\n    let pt0 = makePoint(p1[0], p1[1], 0);\n    let pt1 = makePoint(p2[0], p2[1], 0);\n    let x = makeVectorFromPoints(pt0, pt1);\n    let unitX = unitVector(x);\n    pt1 = addVector(pt0, multiplyVector(unitX, arrowLength));\n    x = makeVectorFromPoints(pt0, pt1);\n    let unitZ = makeVector(0, 0, 1);\n    let unitY = unitVector(crossProduct(unitX, unitZ));\n    let thickness = a.width || 10;\n\n    let A = addVector(pt0, multiplyVector(unitY, thickness * 0.5));\n    let B = addVector(A, multiplyVector(unitX, magnitude(x) - thickness * 2.0));\n    let C = addVector(B, multiplyVector(unitY, thickness));\n    let D = pt1;\n    let G = addVector(pt0, multiplyVector(negateVector(unitY), thickness * 0.5));\n    let F = addVector(G, multiplyVector(unitX, magnitude(x) - thickness * 2.0));\n    let E = addVector(F, multiplyVector(negateVector(unitY), thickness));\n\n    let points = '' +\n      A.x + ',' + A.y + ' ' +\n      B.x + ',' + B.y + ' ' +\n      C.x + ',' + C.y + ' ' +\n      D.x + ',' + D.y + ' ' +\n      E.x + ',' + E.y + ' ' +\n      F.x + ',' + F.y + ' ' +\n      G.x + ',' + G.y;\n\n    setAttributes(arrow, {\n      points: points,\n      stroke: normalizeColor(a.color || '#000'),\n      fill: normalizeColor(a.color || '#000')\n    });\n  }\n\n  return arrow;\n}\n","import { getTranslation } from '../render/appendChild';\nimport {\n  applyTransform,\n  applyInverseTransform,\n  translate,\n  rotate,\n  scale\n} from '../utils/mathUtils';\n\nexport const BORDER_COLOR = '#00BFFF';\n\nconst userSelectStyleSheet = document.createElement('style');\nuserSelectStyleSheet.innerHTML = `\nbody {\n  -webkit-user-select: none;\n  -moz-user-select: none;\n  -ms-user-select: none;\n  user-select: none;\n}\n`;\n\nuserSelectStyleSheet.setAttribute('data-pdf-annotate-user-select', 'true');\n\n/**\n * Find the SVGElement that contains all the annotations for a page\n *\n * @param {Element} node An annotation within that container\n * @return {SVGElement} The container SVG or null if it can't be found\n */\nexport function findSVGContainer(node) {\n  let parentNode = node;\n\n  while ((parentNode = parentNode.parentNode) &&\n          parentNode !== document) {\n    if (parentNode.nodeName.toUpperCase() === 'SVG' &&\n        parentNode.getAttribute('data-pdf-annotate-container') === 'true') {\n      return parentNode;\n    }\n  }\n\n  return null;\n}\n\n/**\n * Find whether x, y are in 'no-annotation' area.\n * @param {Number} x The x coordinate of the point\n * @param {Number} y The y coordinate of the point\n * @returns {Boolean} Whether in the forbidden area\n */\nexport function isInForbiddenArea(x, y) {\n  let pointElements = document.elementsFromPoint(x, y);\n  for (let i = 0, l = pointElements.length; i < l; i++) {\n    if (pointElements[i].classList.contains('no-annotation')) {\n      return true;\n    }\n  }\n  return false;\n}\n\n/**\n * Find an SVGElement container at a given point\n *\n * @param {Number} x The x coordinate of the point\n * @param {Number} y The y coordinate of the point\n * @return {SVGElement} The container SVG or null if one can't be found\n */\nexport function findSVGAtPoint(x, y) {\n  let elements = document.querySelectorAll('svg[data-pdf-annotate-container=\"true\"]');\n\n  if (isInForbiddenArea(x, y)) {\n    return;\n  }\n\n  for (let i = 0, l = elements.length; i < l; i++) {\n    let el = elements[i];\n    let rect = el.getBoundingClientRect();\n\n    if (pointIntersectsRect(x, y, rect)) {\n      return el;\n    }\n  }\n\n  return null;\n}\n\n/**\n * Find an Element that represents an annotation at a given point.\n *\n * IMPORTANT: Requires the annotation layer to be the top most element so\n *            either use z-ordering or make it the leaf container.\n *\n * @param {Number} x The x coordinate of the point\n * @param {Number} y The y coordinate of the point\n * @return {Element|null} The annotation element or null if one can't be found\n */\nexport function findAnnotationAtPoint(x, y) {\n  // let el = null;\n  // let candidate = document.elementFromPoint(x, y);\n  // while (!el && candidate && candidate !== document) {\n  //   let type = candidate.getAttribute('data-pdf-annotate-type');\n  //   if (type) {\n  //     el = candidate;\n  //   }\n  //   candidate = candidate.parentNode;\n  // }\n  // return el;\n  let svg = findSVGAtPoint(x, y);\n  if (!svg) { return; }\n  let elements = svg.querySelectorAll('[data-pdf-annotate-type]');\n\n  // Find a target element within SVG\n  for (let i = 0, l = elements.length; i < l; i++) {\n    let el = elements[i];\n    if (pointIntersectsRect(x, y, getOffsetAnnotationRect(el))) {\n      return el;\n    }\n  }\n\n  return null;\n}\n\n/**\n * Determine if a point intersects a rect\n *\n * @param {Number} x The x coordinate of the point\n * @param {Number} y The y coordinate of the point\n * @param {Object} rect The points of a rect (likely from getBoundingClientRect)\n * @return {Boolean} True if a collision occurs, otherwise false\n */\nexport function pointIntersectsRect(x, y, rect) {\n  return y >= rect.top && y <= rect.bottom && x >= rect.left && x <= rect.right;\n}\n\n/**\n * Get the rect of an annotation element accounting for offset.\n *\n * @param {Element} el The element to get the rect of\n * @param {Boolean} offset Handling offset in this function or not\n * @return {Object} The dimensions of the element\n */\nexport function getOffsetAnnotationRect(el, offset = false) {\n  let rect = el.getBoundingClientRect();\n  let { width, height } = rect;\n  let extraOffsetWidth = 0;\n  let extraOffsetHeight = 0;\n  // if (['line', 'path'].indexOf(el.tagName.toLowerCase()) > -1 && el.getBBox) {\n  if (['line'].indexOf(el.tagName.toLowerCase()) > -1 && el.getBBox) {\n    let bbox = el.getBBox();\n    extraOffsetWidth = (rect.width - bbox.width) / 2;\n    extraOffsetHeight = (rect.height - bbox.height) / 2;\n    width = bbox.width;\n    height = bbox.height;\n  }\n  let { offsetLeft, offsetTop } = getOffset(el);\n  if (!offset) {\n    offsetLeft = 0;\n    offsetTop = 0;\n  }\n  return {\n    top: rect.top - offsetTop + extraOffsetHeight,\n    left: rect.left - offsetLeft + extraOffsetWidth,\n    bottom: rect.bottom - offsetTop - extraOffsetHeight,\n    right: rect.right - offsetLeft - extraOffsetWidth,\n    width: width,\n    height: height\n  };\n}\n\n/**\n * Adjust scale from normalized scale (100%) to rendered scale.\n *\n * @param {SVGElement} svg The SVG to gather metadata from\n * @param {Object} rect A map of numeric values to scale\n * @return {Object} A copy of `rect` with values scaled up\n */\nexport function scaleUp(svg, rect) {\n  let result = {};\n  let { viewport } = getMetadata(svg);\n\n  Object.keys(rect).forEach((key) => {\n    result[key] = rect[key] * viewport.scale;\n  });\n\n  return result;\n}\n\nexport function convertToSvgRect(rect, svg, viewport) {\n  let pt1 = [rect.x, rect.y];\n  let pt2 = [rect.x + rect.width, rect.y + rect.height];\n\n  pt1 = convertToSvgPoint(pt1, svg, viewport);\n  pt2 = convertToSvgPoint(pt2, svg, viewport);\n\n  return {\n    x: Math.min(pt1[0], pt2[0]),\n    y: Math.min(pt1[1], pt2[1]),\n    width: Math.abs(pt2[0] - pt1[0]),\n    height: Math.abs(pt2[1] - pt1[1])\n  };\n}\n\nexport function convertToSvgPoint(pt, svg, viewport) {\n  viewport = viewport || getMetadata(svg).viewport;\n\n  let xform = [ 1, 0, 0, 1, 0, 0 ];\n  xform = scale(xform, viewport.scale, viewport.scale);\n  xform = rotate(xform, viewport.rotation);\n\n  let offset = getTranslation(viewport);\n  xform = translate(xform, offset.x, offset.y);\n\n  return applyInverseTransform(pt, xform);\n}\n\nexport function convertToScreenPoint(pt, svg, viewport) {\n  viewport = viewport || getMetadata(svg).viewport;\n\n  let xform = [ 1, 0, 0, 1, 0, 0 ];\n  xform = scale(xform, viewport.scale, viewport.scale);\n  xform = rotate(xform, viewport.rotation);\n\n  let offset = getTranslation(viewport);\n  xform = translate(xform, offset.x, offset.y);\n\n  return applyTransform(pt, xform);\n}\n\n/**\n * Adjust scale from rendered scale to a normalized scale (100%).\n *\n * @param {SVGElement} svg The SVG to gather metadata from\n * @param {Object} rect A map of numeric values to scale\n * @return {Object} A copy of `rect` with values scaled down\n */\nexport function scaleDown(svg, rect) {\n  let result = {};\n  let { viewport } = getMetadata(svg);\n\n  Object.keys(rect).forEach((key) => {\n    result[key] = rect[key] / viewport.scale;\n  });\n\n  return result;\n}\n\n/**\n * Get the scroll position of an element, accounting for parent elements\n *\n * @param {Element} el The element to get the scroll position for\n * @return {Object} The scrollTop and scrollLeft position\n */\nexport function getScroll(el) {\n  let scrollTop = 0;\n  let scrollLeft = 0;\n  let parentNode = el;\n\n  while ((parentNode = parentNode.parentNode) &&\n          parentNode !== document) {\n    scrollTop += parentNode.scrollTop;\n    scrollLeft += parentNode.scrollLeft;\n  }\n\n  return { scrollTop, scrollLeft };\n}\n\n/**\n * Get the offset position of an element, accounting for parent elements\n *\n * @param {Element} el The element to get the offset position for\n * @return {Object} The offsetTop and offsetLeft position\n */\nexport function getOffset(el) {\n  let parentNode = el;\n\n  while ((parentNode = parentNode.parentNode) &&\n          parentNode !== document) {\n    if (parentNode.nodeName.toUpperCase() === 'SVG') {\n      break;\n    }\n  }\n\n  let rect = parentNode.getBoundingClientRect();\n\n  return { offsetLeft: rect.left, offsetTop: rect.top };\n}\n\n/**\n * Disable user ability to select text on page\n */\nexport function disableUserSelect() {\n  if (!userSelectStyleSheet.parentNode) {\n    document.head.appendChild(userSelectStyleSheet);\n  }\n}\n\n/**\n * Enable user ability to select text on page\n */\nexport function enableUserSelect() {\n  if (userSelectStyleSheet.parentNode) {\n    userSelectStyleSheet.parentNode.removeChild(userSelectStyleSheet);\n  }\n}\n\n/**\n * Get the metadata for a SVG container\n *\n * @param {SVGElement} svg The SVG container to get metadata for\n * @returns {Object} Metadata (Document ID, Page num & viewport info)\n */\nexport function getMetadata(svg) {\n  return {\n    documentId: svg.getAttribute('data-pdf-annotate-document'),\n    pageNumber: parseInt(svg.getAttribute('data-pdf-annotate-page'), 10),\n    viewport: JSON.parse(svg.getAttribute('data-pdf-annotate-viewport'))\n  };\n}\n","import EventEmitter from 'events';\nimport {\n  findAnnotationAtPoint,\n  findSVGAtPoint\n} from './utils';\n\nconst emitter = new EventEmitter();\n\nlet clickNode;\nlet _enabled = true;\n\n/**\n * Handle document.click event\n *\n * @param {Event} e The DOM event to be handled\n */\ndocument.addEventListener('click', function handleDocumentClick(e) {\n  if (!_enabled) {\n    return;\n  }\n\n  if (!findSVGAtPoint(e.clientX, e.clientY)) {\n    return;\n  }\n\n  let target = findAnnotationAtPoint(e.clientX, e.clientY);\n\n  // Emit annotation:blur if clickNode is no longer clicked\n  if (clickNode && clickNode !== target) {\n    emitter.emit('annotation:blur', clickNode);\n  }\n\n  // Emit annotation:click if target was clicked\n  if (target) {\n    emitter.emit('annotation:click', target);\n  }\n\n  clickNode = target;\n});\n\n// let mouseOverNode;\n// document.addEventListener('mousemove', function handleDocumentMousemove(e) {\n//   let target = findAnnotationAtPoint(e.clientX, e.clientY);\n//\n//   // Emit annotation:mouseout if target was mouseout'd\n//   if (mouseOverNode && !target) {\n//     emitter.emit('annotation:mouseout', mouseOverNode);\n//   }\n//\n//   // Emit annotation:mouseover if target was mouseover'd\n//   if (target && mouseOverNode !== target) {\n//     emitter.emit('annotation:mouseover', target);\n//   }\n//\n//   mouseOverNode = target;\n// });\n\nexport function fireEvent() { emitter.emit(...arguments); };\nexport function addEventListener() { emitter.on(...arguments); };\nexport function removeEventListener() { emitter.removeListener(...arguments); };\nexport function removeAllEventListener() { emitter.removeAllListeners(...arguments); };\nexport function enableUI() {\n  _enabled = true;\n}\nexport function disableUI() {\n  _enabled = false;\n}\n","// Disable JSDoc as it cannot really deal with the odd way that the functions are defined\n/* eslint valid-jsdoc: 0 */\n\nimport abstractFunction from '../utils/abstractFunction';\nimport { fireEvent } from '../UI/event';\n\n// Adapter should never be invoked publicly\nexport default class StoreAdapter {\n  /**\n   * Create a new StoreAdapter instance\n   *\n   * @param {Object} [definition] The definition to use for overriding abstract methods\n   */\n  constructor(definition = {}) {\n    // Copy each function from definition if it is a function we know about\n    Object.keys(definition).forEach((key) => {\n      if (typeof definition[key] === 'function' &&\n          typeof this[key] === 'function') {\n        this[key] = definition[key];\n      }\n    });\n    this.history = {};\n  }\n\n  /**\n   * Get all the annotations for a given document.\n   *\n   * @param {String} documentId The ID for the document the annotations belong to\n   * @return {Promise} Promise that returns with list of annotations for document\n   */\n  __getAllAnnotations(documentId) { abstractFunction('getAllAnnotations'); }\n  get getAllAnnotations() { return this.__getAllAnnotations; }\n  set getAllAnnotations(fn) {\n    this.__getAllAnnotations = function getAllAnnotations(documentId) {\n      return fn(...arguments).then((annotations) => {\n        // TODO may be best to have this happen on the server\n        if (annotations.annotations) {\n          annotations.annotations.forEach((a) => {\n            a.documentId = documentId;\n          });\n        }\n        return annotations;\n      });\n    };\n  }\n\n  /**\n   * Get all the annotations for a given document and page number.\n   *\n   * @param {String} documentId The ID for the document the annotations belong to\n   * @param {Number} pageNumber The number of the page the annotations belong to\n   * @return {Promise} Promise that returns with list of annotations for document and page\n   */\n  __getAnnotations(documentId, pageNumber) { abstractFunction('getAnnotations'); }\n  get getAnnotations() { return this.__getAnnotations; }\n  set getAnnotations(fn) {\n    this.__getAnnotations = function getAnnotations(documentId, pageNumber) {\n      return fn(...arguments).then((annotations) => {\n        // TODO may be best to have this happen on the server\n        if (annotations.annotations) {\n          annotations.annotations.forEach((a) => {\n            a.documentId = documentId;\n          });\n        }\n        return annotations;\n      });\n    };\n  }\n\n  /**\n   * Get the definition for a specific annotation.\n   *\n   * @param {String} documentId The ID for the document the annotation belongs to\n   * @param {String} annotationId The ID for the annotation\n   * @return {Promise} Promise that returns the requested annotation\n   */\n  getAnnotation(documentId, annotationId) { abstractFunction('getAnnotation'); }\n\n  /**\n   * Add an annotation\n   *\n   * @param {String} documentId The ID for the document to add the annotation to\n   * @param {String} pageNumber The page number to add the annotation to\n   * @param {Object} annotation The definition for the new annotation\n   * @return {Promise} Promise that returns with the added annotation\n   */\n  __addAnnotation(documentId, pageNumber, annotation) { abstractFunction('addAnnotation'); }\n  get addAnnotation() { return this.__addAnnotation; }\n  set addAnnotation(fn) {\n    this.__addAnnotation = function addAnnotation(documentId, pageNumber, annotation) {\n      return fn(...arguments).then((annotation) => {\n        fireEvent('annotation:add', documentId, pageNumber, annotation);\n        return annotation;\n      });\n    };\n  }\n\n  /**\n   * Edit an annotation\n   *\n   * @param {String} documentId The ID for the document\n   * @param {String} pageNumber the page number of the annotation\n   * @param {Object} annotation The definition of the modified annotation\n   * @return {Promise} Promise that returns with the edited annotation\n   */\n  __editAnnotation(documentId, pageNumber, annotation) { abstractFunction('editAnnotation'); }\n  get editAnnotation() { return this.__editAnnotation; }\n  set editAnnotation(fn) {\n    this.__editAnnotation = function editAnnotation(documentId, annotationId, annotation) {\n      return fn(...arguments).then((annotation) => {\n        fireEvent('annotation:edit', documentId, annotationId, annotation);\n        return annotation;\n      });\n    };\n  }\n\n  /**\n   * Delete an annotation\n   *\n   * @param {String} documentId The ID for the document\n   * @param {String} annotationId The ID for the annotation\n   * @return {Promise} Promise that returns with boolean if annotation was deleted\n   */\n  __deleteAnnotation(documentId, annotationId) { abstractFunction('deleteAnnotation'); }\n  get deleteAnnotation() { return this.__deleteAnnotation; }\n  set deleteAnnotation(fn) {\n    this.__deleteAnnotation = function deleteAnnotation(documentId, annotationId) {\n      return fn(...arguments).then((success) => {\n        if (success) {\n          fireEvent('annotation:delete', documentId, annotationId);\n        }\n        return success;\n      });\n    };\n  }\n\n  /**\n   * Get all the comments for an annotation\n   *\n   * @param {String} documentId The ID for the document\n   * @param {String} annotationId The ID for the annotation\n   * @return {Promise} Promise that returns with comments for annotation\n   */\n  getComments(documentId, annotationId) { abstractFunction('getComments'); }\n\n  /**\n   * Add a new comment\n   *\n   * @param {String} documentId The ID for the document\n   * @param {String} annotationId The ID for the annotation\n   * @param {Object} content The definition of the comment\n   * @return {Promise} Promise that returns with the added comment\n   */\n  __addComment(documentId, annotationId, content) { abstractFunction('addComment'); }\n  get addComment() { return this.__addComment; }\n  set addComment(fn) {\n    this.__addComment = function addComment(documentId, annotationId, content) {\n      return fn(...arguments).then((comment) => {\n        fireEvent('comment:add', documentId, annotationId, comment);\n        return comment;\n      });\n    };\n  }\n\n  /**\n   * Delete a comment\n   *\n   * @param {String} documentId The ID for the document\n   * @param {String} commentId The ID for the comment\n   * @return {Promise} Promise that returns with boolean if comment was deleted\n   */\n  __deleteComment(documentId, commentId) { abstractFunction('deleteComment'); }\n  get deleteComment() { return this.__deleteComment; }\n  set deleteComment(fn) {\n    this.__deleteComment = function deleteComment(documentId, commentId) {\n      return fn(...arguments).then((success) => {\n        if (success) {\n          fireEvent('comment:delete', documentId, commentId);\n        }\n        return success;\n      });\n    };\n  }\n\n  /**\n   * Undo an operation.\n   *\n   * @param {String} documentId The ID for the document the annotations belong to\n   * @return {Promise} Promise that returns with boolean if undo successes\n   */\n  __undo(documentId) { abstractFunction('undo'); }\n  get undo() { return this.__undo; }\n  set undo(fn) {\n    this.__undo = function undo(documentId) {\n      return fn(...arguments).then((success) => {\n        if (success) {\n          // do what?\n        }\n        return success;\n      });\n    };\n  }\n\n  /**\n   * Redo an operation.\n   *\n   * @param {String} documentId The ID for the document the annotations belong to\n   * @return {Promise} Promise that returns with boolean if redo successes\n   */\n  __redo(documentId) { abstractFunction('redo'); }\n  get redo() { return this.__redo; }\n  set redo(fn) {\n    this.__redo = function redo(documentId) {\n      return fn(...arguments).then((success) => {\n        if (success) {\n          // do what?\n        }\n        return success;\n      });\n    };\n  }\n\n  /**\n   * Clear history array.\n   *\n   * @param {String} documentId The ID for the document the annotations belong to\n   * @return {Promise} Promise that returns with boolean if clear successes\n   */\n  __clearHistory(documentId) { abstractFunction('clearHistory'); }\n  get clearHistory() { return this.__clearHistory; }\n  set clearHistory(fn) {\n    this.__clearHistory = function clearHistory(documentId) {\n      return fn(...arguments).then((success) => {\n        if (success) {\n          // do what?\n        }\n        return success;\n      });\n    };\n  }\n\n  /**\n   * Return undo, redo and clear status.\n   *\n   * @param {String} documentId The ID for the document the annotations belong to\n   * @return {Promise} Promise that returns with a list of 3 booleans\n   */\n  historyStatus(documentId) { abstractFunction('historyStatus'); }\n}\n","const REGEXP = /[xy]/g;\nconst PATTERN = 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx';\n\nfunction replacement(c) {\n  let r = Math.random() * 16 | 0;\n  let v = c === 'x' ? r : (r & 0x3 | 0x8);\n  return v.toString(16);\n}\n\n/**\n * Generate a univierally unique identifier\n *\n * @return {String} A UUID\n */\nexport default function uuid() {\n  return PATTERN.replace(REGEXP, replacement);\n}\n","import uuid from '../utils/uuid';\nimport StoreAdapter from './StoreAdapter';\n\n// StoreAdapter for working with localStorage\n// This is ideal for testing, examples, and prototyping\nexport default class LocalStoreAdapter extends StoreAdapter {\n  constructor() {\n    super({\n      getAnnotations(documentId, pageNumber) {\n        return new Promise((resolve, reject) => {\n          let annotations = getAnnotations(documentId).filter((i) => {\n            return i.page === pageNumber && i.class === 'Annotation';\n          });\n\n          resolve({\n            documentId,\n            pageNumber,\n            annotations\n          });\n        });\n      }\n    });\n\n    this.getAnnotation = (documentId, annotationId) => {\n      return Promise.resolve(getAnnotations(documentId)[findAnnotation(documentId, annotationId)]);\n    };\n\n    this.addAnnotation = (documentId, pageNumber, annotation) => {\n      return new Promise((resolve, reject) => {\n        annotation.class = 'Annotation';\n        annotation.uuid = uuid();\n        annotation.page = pageNumber;\n\n        let annotations = getAnnotations(documentId);\n        annotations.push(annotation);\n        updateAnnotations(documentId, annotations, this.history);\n\n        resolve(annotation);\n      });\n    };\n\n    this.editAnnotation = (documentId, annotationId, annotation) => {\n      return new Promise((resolve, reject) => {\n        let annotations = getAnnotations(documentId);\n        annotations[findAnnotation(documentId, annotationId)] = annotation;\n        updateAnnotations(documentId, annotations, this.history);\n        resolve(annotation);\n      });\n    };\n\n    this.deleteAnnotation = (documentId, annotationId) => {\n      return new Promise((resolve, reject) => {\n        let annotation = getAnnotations(documentId).filter(i => i.uuid === annotationId)[0] || {};\n        if (!annotation) {\n          return reject('Could not find annotation');\n        }\n        let index = findAnnotation(documentId, annotationId);\n        if (index > -1) {\n          let annotations = getAnnotations(documentId);\n          annotations.splice(index, 1);\n          updateAnnotations(documentId, annotations, this.history);\n        }\n\n        resolve(true);\n      });\n    };\n\n    this.getComments = (documentId, annotationId) => {\n      return new Promise((resolve, reject) => {\n        resolve(getAnnotations(documentId).filter((i) => {\n          return i.class === 'Comment' && i.annotation === annotationId;\n        }));\n      });\n    };\n\n    this.addComment = (documentId, annotationId, content) => {\n      return new Promise((resolve, reject) => {\n        let comment = {\n          class: 'Comment',\n          uuid: uuid(),\n          annotation: annotationId,\n          content: content\n        };\n\n        let annotations = getAnnotations(documentId);\n        annotations.push(comment);\n        updateAnnotations(documentId, annotations, this.history);\n\n        resolve(comment);\n      });\n    };\n\n    this.deleteComment = (documentId, commentId) => {\n      return new Promise((resolve, reject) => {\n        let comment = getAnnotations(documentId).filter(i => i.uuid === commentId)[0] || {};\n        if (!comment) {\n          return reject('Could not find annotation');\n        }\n        let index = -1;\n        let annotations = getAnnotations(documentId);\n        for (let i = 0, l = annotations.length; i < l; i++) {\n          if (annotations[i].uuid === commentId) {\n            index = i;\n            break;\n          }\n        }\n\n        if (index > -1) {\n          annotations.splice(index, 1);\n          updateAnnotations(documentId, annotations, this.history);\n        }\n\n        resolve(true);\n      });\n    };\n\n    this.getAllAnnotations = (documentId) => {\n      return new Promise((resolve, reject) => {\n        let annotations = getAnnotations(documentId);\n        resolve(annotations);\n      });\n    };\n\n    this.undo = (documentId) => {\n      return new Promise((resolve, reject) => {\n        if (!this.history[documentId] || this.history[documentId]['idx'] === 0) {\n          return reject('No history now.');\n        }\n        else {\n          let idx = this.history[documentId]['idx'];\n          console.log(idx);\n          if (!this.history[documentId]['record'][idx - 1]) {\n            return reject('invalid idx.');\n          }\n          else {\n            let annotations = this.history[documentId]['record'][idx - 1];\n            this.history[documentId]['idx'] = idx - 1;\n            updateAnnotations(documentId, annotations);\n            resolve(true);\n          }\n        }\n      });\n    };\n\n    this.redo = (documentId) => {\n      return new Promise((resolve, reject) => {\n        if (!this.history[documentId]) {\n          return reject('No history now.');\n        }\n        else {\n          let idx = this.history[documentId]['idx'];\n          console.log(idx);\n          if (!this.history[documentId]['record'][idx + 1]) {\n            return reject('invalid idx.');\n          }\n          else {\n            let annotations = this.history[documentId]['record'][idx + 1];\n            this.history[documentId]['idx'] = idx + 1;\n            updateAnnotations(documentId, annotations);\n            resolve(true);\n          }\n        }\n      });\n    };\n\n    this.clearHistory = (documentId) => {\n      return new Promise((resolve, reject) => {\n        delete this.history[documentId];\n        resolve(true);\n      });\n    };\n\n    this.historyStatus = (documentId) => {\n      // TODO: needs test!\n      return new Promise((resolve, reject) => {\n        let undo = false;\n        let redo = false;\n        let clear = false;\n\n        let idx = null;\n        if (this.history[documentId]) {\n          idx = this.history[documentId]['idx'];\n        }\n        if (!this.history[documentId]) {\n\n        }\n        else {\n          clear = true;\n          if (this.history[documentId]['idx'] !== 0) {\n            undo = true;\n          }\n          if (this.history[documentId]['record'].length > idx) {\n            redo = true;\n          }\n        }\n        resolve([undo, redo, clear]);\n      });\n    };\n  }\n}\n\nfunction getAnnotations(documentId) {\n  let json = localStorage.getItem(`${documentId}/annotations`);\n  if (json === 'undefined') {\n    json = '[]';\n  }\n  return JSON.parse(json) || [];\n}\n\nfunction updateAnnotations(documentId, annotations, history = null) {\n  /* Requires be called at most only once in every function of StoreAdapter */\n  /* As it records history every time it updates item (when history != null) */\n  if (history) {\n    if (!history[documentId]) {\n      history[documentId] = {\n        'record': [getAnnotations(documentId)],\n        'idx': 0 // idx always points to annotation representing current status\n      };\n    }\n    let idx = history[documentId]['idx'];\n    history[documentId]['record'][idx + 1] = annotations;\n    history[documentId]['idx'] = idx + 1;\n    history[documentId]['record'].length = idx + 2;\n    // console.log(history);\n  }\n  localStorage.setItem(`${documentId}/annotations`, JSON.stringify(annotations));\n}\n/**\n *\n * @param {String} documentId Document id of the annotation\n * @param {String} annotationId The id of the annotation\n *\n * This function finds all the annotation made by one user.\n *\n * @return {int} The index of the annotation in localstorage\n */\nfunction findAnnotation(documentId, annotationId) {\n  let index = -1;\n  let annotations = getAnnotations(documentId);\n  for (let i = 0, l = annotations.length; i < l; i++) {\n    if (annotations[i].uuid === annotationId) {\n      index = i;\n      break;\n    }\n  }\n  return index;\n}\n","import uuid from '../utils/uuid';\nimport StoreAdapter from './StoreAdapter';\n\n// StoreAdapter for working with localStorage and associated user id\n// This is ideal for testing, examples, and prototyping\nexport default class LocalUserStoreAdapter extends StoreAdapter {\n  constructor(userId = 'user', globalEdit = false) {\n    super({\n      getAnnotations(documentId, pageNumber) {\n        return new Promise((resolve, reject) => {\n          let annotations = getAllAnnotations(documentId).filter((i) => {\n            return i.page === pageNumber && i.class === 'Annotation';\n          });\n\n          resolve({\n            documentId,\n            pageNumber,\n            annotations\n          });\n        });\n      }\n    });\n\n    this._userId = userId;\n    this._globalEdit = globalEdit;\n\n    this.getAnnotation = (documentId, annotationId) => {\n      return Promise.resolve(getAnnotations(documentId, this._userId)[findAnnotation(documentId, this._userId, annotationId)]);\n    };\n\n    this.addAnnotation = (documentId, pageNumber, annotation) => {\n      return new Promise((resolve, reject) => {\n        annotation.class = 'Annotation';\n        annotation.uuid = uuid();\n        annotation.page = pageNumber;\n        annotation.userId = this._userId;\n\n        let annotations = getAnnotations(documentId, this._userId);\n        annotations.push(annotation);\n        updateAnnotations(documentId, this._userId, annotations, this.history);\n\n        resolve(annotation);\n      });\n    };\n\n    this.editAnnotation = (documentId, annotationId, annotation) => {\n      return new Promise((resolve, reject) => {\n        if (!this._globalEdit && annotation.userId && annotation.userId !== this._userId) {\n          reject('Non-matching userId');\n        }\n        let annotations = getAnnotations(documentId, annotation.userId);\n        annotations[findAnnotation(documentId, annotation.userId, annotationId)] = annotation;\n        updateAnnotations(documentId, annotation.userId, annotations, this.history);\n        resolve(annotation);\n      });\n    };\n\n    this.deleteAnnotation = (documentId, annotationId) => {\n      return new Promise((resolve, reject) => {\n        let annotation = getAllAnnotations(documentId).filter(i => i.uuid === annotationId)[0] || {};\n        if (!annotation) {\n          return reject('Could not find annotation');\n        }\n        else if (!this._globalEdit && annotation.userId && annotation.userId !== this._userId) {\n          return reject('Non-matching userId');\n        }\n        let index = findAnnotation(documentId, annotation.userId, annotationId);\n        if (index > -1) {\n          let annotations = getAnnotations(documentId, annotation.userId);\n          annotations.splice(index, 1);\n          updateAnnotations(documentId, annotation.userId, annotations, this.history);\n        }\n\n        resolve(true);\n      });\n    };\n\n    this.getComments = (documentId, annotationId) => {\n      return new Promise((resolve, reject) => {\n        resolve(getAnnotations(documentId, this._userId).filter((i) => {\n          return i.class === 'Comment' && i.annotation === annotationId;\n        }));\n      });\n    };\n\n    this.addComment = (documentId, annotationId, content) => {\n      return new Promise((resolve, reject) => {\n        let comment = {\n          class: 'Comment',\n          uuid: uuid(),\n          annotation: annotationId,\n          content: content,\n          userId: this._userId\n        };\n\n        let annotations = getAnnotations(documentId, this._userId);\n        annotations.push(comment);\n        updateAnnotations(documentId, this._userId, annotations, this.history);\n\n        resolve(comment);\n      });\n    };\n\n    this.deleteComment = (documentId, commentId) => {\n      return new Promise((resolve, reject) => {\n        let comment = getAllAnnotations(documentId).filter(i => i.uuid === commentId)[0] || {};\n        if (!comment) {\n          return reject('Could not find annotation');\n        }\n        else if (!this._globalEdit && comment.userId && comment.userId !== this._userId) {\n          return reject('Non-matching userId');\n        }\n        let index = -1;\n        let annotations = getAnnotations(documentId, comment.userId);\n        for (let i = 0, l = annotations.length; i < l; i++) {\n          if (annotations[i].uuid === commentId) {\n            index = i;\n            break;\n          }\n        }\n\n        if (index > -1) {\n          annotations.splice(index, 1);\n          updateAnnotations(documentId, comment.userId, annotations, this.history);\n        }\n\n        resolve(true);\n      });\n    };\n\n    this.undo = (documentId) => {\n      return new Promise((resolve, reject) => {\n        if (!this.history[documentId][this._userId] || this.history[documentId][this._userId]['idx'] === 0) {\n          return reject('No history now.');\n        }\n        else {\n          let idx = this.history[documentId][this._userId]['idx'];\n          console.log(idx);\n          if (!this.history[documentId][this._userId]['record'][idx - 1]) {\n            return reject('invalid idx.');\n          }\n          else {\n            let annotations = this.history[documentId][this._userId]['record'][idx - 1];\n            this.history[documentId][this._userId]['idx'] = idx - 1;\n            updateAnnotations(documentId, annotations);\n            resolve(true);\n          }\n        }\n      });\n    };\n\n    this.redo = (documentId) => {\n      return new Promise((resolve, reject) => {\n        if (!this.history[documentId][this._userId]) {\n          return reject('No history now.');\n        }\n        else {\n          let idx = this.history[documentId][this._userId]['idx'];\n          console.log(idx);\n          if (!this.history[documentId][this._userId]['record'][idx + 1]) {\n            return reject('invalid idx.');\n          }\n          else {\n            let annotations = this.history[documentId][this._userId]['record'][idx + 1];\n            this.history[documentId][this._userId]['idx'] = idx + 1;\n            updateAnnotations(documentId, annotations);\n            resolve(true);\n          }\n        }\n      });\n    };\n\n    this.clearHistory = (documentId) => {\n      return new Promise((resolve, reject) => {\n        delete this.history[documentId][this._userId];\n        resolve(true);\n      });\n    };\n\n    this.historyStatus = (documentId) => {\n      // TODO: needs test!\n      return new Promise((resolve, reject) => {\n        let undo = false;\n        let redo = false;\n        let clear = false;\n\n        let idx = null;\n        if (this.history[documentId][this._userId]) {\n          idx = this.history[documentId][this._userId]['idx'];\n        }\n        if (!this.history[documentId][this._userId]) {\n\n        }\n        else {\n          clear = true;\n          if (this.history[documentId][this._userId]['idx'] !== 0) {\n            undo = true;\n          }\n          if (this.history[documentId][this._userId]['record'].length > idx) {\n            redo = true;\n          }\n        }\n        resolve([undo, redo, clear]);\n      });\n    };\n  }\n\n  get userId() {\n    return this._userId;\n  }\n}\n\nfunction getAllAnnotations(documentId) {\n  let all_annotations = [];\n  let re = new RegExp(`${documentId}/(.*)/annotations`);\n  for (let i = 0; i < localStorage.length; i++) {\n    if (localStorage.key(i).search(re) > -1) {\n      all_annotations.push(...JSON.parse(localStorage.getItem(localStorage.key(i))));\n    }\n  }\n  return all_annotations;\n}\n\nfunction getAnnotations(documentId, userId) {\n  return JSON.parse(localStorage.getItem(`${documentId}/${userId}/annotations`)) || [];\n}\n\nfunction updateAnnotations(documentId, userId, annotations, history = null) {\n  /* Requires be called at most only once in every function of StoreAdapter */\n  /* As it records history every time it updates item (when history != null) */\n  if (history) {\n    if (!(history?.[documentId]?.[userId])) {\n      let _ = {\n        'record': [getAnnotations(documentId)],\n        'idx': 0 // idx always points to annotation representing current status\n      };\n      if (!history[documentId]) {\n        history[documentId] = {};\n      }\n      history[documentId][userId] = _;\n    }\n    let idx = history[documentId][userId]['idx'];\n    history[documentId][userId]['record'][idx + 1] = annotations;\n    history[documentId][userId]['idx'] = idx + 1;\n    history[documentId][userId]['record'].length = idx + 2;\n    // console.log(history);\n  }\n  localStorage.setItem(`${documentId}/${userId}/annotations`, JSON.stringify(annotations));\n}\n/**\n *\n * @param {String} documentId Document id of the annotation\n * @param {String} userId User id of the annotation\n * @param {String} annotationId The id of the annotation\n *\n * This function finds all the annotation made by one user.\n *\n * @return {int} The index of the annotation in localstorage\n */\nfunction findAnnotation(documentId, userId, annotationId) {\n  let index = -1;\n  let annotations = getAnnotations(documentId, userId);\n  for (let i = 0, l = annotations.length; i < l; i++) {\n    if (annotations[i].uuid === annotationId) {\n      index = i;\n      break;\n    }\n  }\n  return index;\n}\n","export default {\n  annotationLayerName: 'annotationLayer',\n  textLayerName: 'textLayer',\n  annotationSvgQuery: function() {\n    return 'svg.' + this.annotationLayerName;\n  },\n  annotationClassQuery: function() {\n    return '.' + this.annotationLayerName;\n  },\n  textClassQuery: function() {\n    return '.' + this.textLayerName;\n  }\n};\n","import PDFJSAnnotate from '../PDFJSAnnotate';\nimport config from '../config';\nimport {\n  addEventListener,\n  removeEventListener\n} from './event';\nimport {\n  BORDER_COLOR,\n  disableUserSelect,\n  enableUserSelect,\n  findSVGContainer,\n  findSVGAtPoint,\n  getOffsetAnnotationRect,\n  getMetadata,\n  convertToSvgPoint,\n  scaleDown\n} from './utils';\nimport { appendChild } from '../render/appendChild';\n\nlet _enabled = false;\nlet isDragging = false;\nlet overlay;\nlet dragOffsetX, dragOffsetY, dragStartX, dragStartY;\nconst OVERLAY_BORDER_SIZE = 3;\n\n/**\n * Create an overlay for editing an annotation.\n *\n * @param {Element} target The annotation element to apply overlay for\n */\nexport function createEditOverlay(target) {\n  destroyEditOverlay();\n  overlay = document.createElement('div');\n  let anchor = document.createElement('a');\n  let parentNode = findSVGContainer(target).parentNode;\n  let id = target.getAttribute('data-pdf-annotate-id');\n  let rect = getOffsetAnnotationRect(target, true);\n  let styleLeft = rect.left - OVERLAY_BORDER_SIZE;\n  let styleTop = rect.top - OVERLAY_BORDER_SIZE;\n\n  overlay.setAttribute('id', 'pdf-annotate-edit-overlay');\n  overlay.setAttribute('data-target-id', id);\n  overlay.style.boxSizing = 'content-box';\n  overlay.style.position = 'absolute';\n  overlay.style.top = `${styleTop}px`;\n  overlay.style.left = `${styleLeft}px`;\n  overlay.style.width = `${rect.width}px`;\n  overlay.style.height = `${rect.height}px`;\n  overlay.style.border = `${OVERLAY_BORDER_SIZE}px solid ${BORDER_COLOR}`;\n  overlay.style.borderRadius = `${OVERLAY_BORDER_SIZE}px`;\n  overlay.style.zIndex = 20100;\n\n  anchor.innerHTML = '';\n  anchor.setAttribute('href', 'javascript://');\n  anchor.style.background = '#fff';\n  anchor.style.borderRadius = '20px';\n  anchor.style.border = '1px solid #bbb';\n  anchor.style.color = '#bbb';\n  anchor.style.fontSize = '16px';\n  anchor.style.padding = '2px';\n  anchor.style.textAlign = 'center';\n  anchor.style.textDecoration = 'none';\n  anchor.style.position = 'absolute';\n  anchor.style.top = '-13px';\n  anchor.style.right = '-13px';\n  anchor.style.width = '25px';\n  anchor.style.height = '25px';\n\n  overlay.appendChild(anchor);\n  parentNode.appendChild(overlay);\n  document.addEventListener('click', handleDocumentClick);\n  document.addEventListener('keyup', handleDocumentKeyup);\n  document.addEventListener('mousedown', handleDocumentMousedown);\n  anchor.addEventListener('click', deleteAnnotation);\n  anchor.addEventListener('mouseover', () => {\n    anchor.style.color = '#35A4DC';\n    anchor.style.borderColor = '#999';\n    anchor.style.boxShadow = '0 1px 1px #ccc';\n  });\n  anchor.addEventListener('mouseout', () => {\n    anchor.style.color = '#bbb';\n    anchor.style.borderColor = '#bbb';\n    anchor.style.boxShadow = '';\n  });\n  overlay.addEventListener('mouseover', () => {\n    if (!isDragging) { anchor.style.display = ''; }\n  });\n  overlay.addEventListener('mouseout', () => {\n    anchor.style.display = 'none';\n  });\n}\n\n/**\n * Destroy the edit overlay if it exists.\n */\nexport function destroyEditOverlay() {\n  if (overlay) {\n    overlay.parentNode.removeChild(overlay);\n    overlay = null;\n  }\n\n  document.removeEventListener('click', handleDocumentClick);\n  document.removeEventListener('keyup', handleDocumentKeyup);\n  document.removeEventListener('mousedown', handleDocumentMousedown);\n  document.removeEventListener('mousemove', handleDocumentMousemove);\n  document.removeEventListener('mouseup', handleDocumentMouseup);\n  enableUserSelect();\n}\n\n/**\n * Delete currently selected annotation\n */\nfunction deleteAnnotation() {\n  if (!overlay) {\n    return;\n  }\n\n  let annotationId = overlay.getAttribute('data-target-id');\n  let svg = overlay.parentNode.querySelector(config.annotationSvgQuery());\n  let { documentId } = getMetadata(svg);\n\n  PDFJSAnnotate.getStoreAdapter().deleteAnnotation(documentId, annotationId).then(() => {\n    let nodes = document.querySelectorAll(`[data-pdf-annotate-id=\"${annotationId}\"]`);\n\n    [...nodes].forEach((n) => {\n      n.parentNode.removeChild(n);\n    });\n  });\n\n  destroyEditOverlay();\n}\n\n/**\n * Handle document.click event\n *\n * @param {Event} e The DOM event that needs to be handled\n */\nfunction handleDocumentClick(e) {\n  if (!findSVGAtPoint(e.clientX, e.clientY)) { return; }\n\n  // Remove current overlay\n  let overlay = document.getElementById('pdf-annotate-edit-overlay');\n  if (overlay) {\n    if (isDragging || e.target === overlay) {\n      return;\n    }\n\n    destroyEditOverlay();\n  }\n}\n\n/**\n * Handle document.keyup event\n *\n * @param {KeyboardEvent} e The DOM event that needs to be handled\n */\nfunction handleDocumentKeyup(e) {\n  // keyCode is deprecated, so prefer the newer \"key\" method if possible\n  let keyTest;\n  if (e.key) {\n    keyTest = e.key.toLowerCase() === 'delete' || e.key.toLowerCase() === 'backspace';\n  }\n  else {\n    keyTest = e.keyCode === 8 || e.keyCode === 46;\n  }\n  if (overlay && keyTest &&\n      e.target.nodeName.toLowerCase() !== 'textarea' &&\n      e.target.nodeName.toLowerCase() !== 'input') {\n    e.preventDefault();\n    deleteAnnotation();\n  }\n}\n\n/**\n * Handle document.mousedown event\n *\n * @param {Event} e The DOM event that needs to be handled\n */\nfunction handleDocumentMousedown(e) {\n  if (e.target !== overlay) {\n    return;\n  }\n\n  // Highlight and strikeout annotations are bound to text within the document.\n  // It doesn't make sense to allow repositioning these types of annotations.\n  let annotationId = overlay.getAttribute('data-target-id');\n  let target = document.querySelector(`[data-pdf-annotate-id=\"${annotationId}\"]`);\n  let type = target.getAttribute('data-pdf-annotate-type');\n\n  if (type === 'highlight' || type === 'strikeout') { return; }\n\n  isDragging = true;\n  dragOffsetX = e.clientX;\n  dragOffsetY = e.clientY;\n  dragStartX = overlay.offsetLeft;\n  dragStartY = overlay.offsetTop;\n\n  overlay.style.background = 'rgba(255, 255, 255, 0.7)';\n  overlay.style.cursor = 'move';\n  overlay.querySelector('a').style.display = 'none';\n\n  document.addEventListener('mousemove', handleDocumentMousemove);\n  document.addEventListener('mouseup', handleDocumentMouseup);\n  disableUserSelect();\n}\n\n/**\n * Handle document.mousemove event\n *\n * @param {Event} e The DOM event that needs to be handled\n */\nfunction handleDocumentMousemove(e) {\n  let parentNode = overlay.parentNode;\n  let rect = parentNode.getBoundingClientRect();\n  let y = (dragStartY + (e.clientY - dragOffsetY));\n  let x = (dragStartX + (e.clientX - dragOffsetX));\n  let minY = 0;\n  let maxY = rect.height;\n  let minX = 0;\n  let maxX = rect.width;\n\n  if (y > minY && y + overlay.offsetHeight < maxY) {\n    overlay.style.top = `${y}px`;\n  }\n\n  if (x > minX && x + overlay.offsetWidth < maxX) {\n    overlay.style.left = `${x}px`;\n  }\n}\n\n/**\n * Handle document.mouseup event\n *\n * @param {Event} e The DOM event that needs to be handled\n */\nfunction handleDocumentMouseup(e) {\n  let annotationId = overlay.getAttribute('data-target-id');\n  let target = document.querySelectorAll(`[data-pdf-annotate-id=\"${annotationId}\"]`);\n  let type = target[0].getAttribute('data-pdf-annotate-type');\n  let svg = overlay.parentNode.querySelector(config.annotationSvgQuery());\n  let { documentId } = getMetadata(svg);\n\n  overlay.querySelector('a').style.display = '';\n\n  // Move annotation\n  PDFJSAnnotate.getStoreAdapter().getAnnotation(documentId, annotationId).then((annotation) => {\n    let attribX = 'x';\n    let attribY = 'y';\n    if (['circle', 'fillcircle', 'emptycircle'].indexOf(type) > -1) {\n      attribX = 'cx';\n      attribY = 'cy';\n    }\n\n    if (type === 'point') {\n      [...target].forEach((t, i) => {\n        let moveTo = {\n          x: overlay.offsetLeft,\n          y: overlay.offsetTop\n        };\n        let scaled_pos = scaleDown(svg, moveTo);\n        t.setAttribute(attribX, scaled_pos.x);\n        t.setAttribute(attribY, scaled_pos.y);\n        annotation[attribX] = scaled_pos.x;\n        annotation[attribY] = scaled_pos.y;\n      });\n    }\n    else if (['area', 'highlight', 'textbox', 'circle', 'fillcircle', 'emptycircle'].indexOf(type) > -1) {\n      let modelStart = convertToSvgPoint([dragStartX, dragStartY], svg);\n      let modelEnd = convertToSvgPoint([overlay.offsetLeft, overlay.offsetTop], svg);\n      let modelDelta = {\n        x: modelEnd[0] - modelStart[0],\n        y: modelEnd[1] - modelStart[1]\n      };\n\n      if (type === 'textbox') {\n        // <text> and <tspan> both need to be targets.\n        target = [target[0].firstChild, target[0].firstChild.firstChild];\n      }\n\n      [...target].forEach((t, i) => {\n        let modelX = parseInt(t.getAttribute(attribX), 10);\n        let modelY = parseInt(t.getAttribute(attribY), 10);\n        if (modelDelta.y !== 0) {\n          modelY = modelY + modelDelta.y;\n\n          t.setAttribute(attribY, modelY);\n          if (annotation.rectangles && i < annotation.rectangles.length) {\n            annotation.rectangles[i].y = modelY;\n          }\n          else if (annotation[attribY]) {\n            annotation[attribY] = modelY;\n          }\n        }\n        if (modelDelta.x !== 0) {\n          modelX = modelX + modelDelta.x;\n\n          t.setAttribute(attribX, modelX);\n          if (annotation.rectangles && i < annotation.rectangles.length) {\n            annotation.rectangles[i].x = modelX;\n          }\n          else if (annotation[attribX]) {\n            annotation[attribX] = modelX;\n          }\n        }\n      });\n    }\n    else if (type === 'strikeout') {\n      return;\n    //   let { deltaX, deltaY } = getDelta('x1', 'y1');\n    //   [...target].forEach(target, (t, i) => {\n    //     if (deltaY !== 0) {\n    //       t.setAttribute('y1', parseInt(t.getAttribute('y1'), 10) + deltaY);\n    //       t.setAttribute('y2', parseInt(t.getAttribute('y2'), 10) + deltaY);\n    //       annotation.rectangles[i].y = parseInt(t.getAttribute('y1'), 10);\n    //     }\n    //     if (deltaX !== 0) {\n    //       t.setAttribute('x1', parseInt(t.getAttribute('x1'), 10) + deltaX);\n    //       t.setAttribute('x2', parseInt(t.getAttribute('x2'), 10) + deltaX);\n    //       annotation.rectangles[i].x = parseInt(t.getAttribute('x1'), 10);\n    //     }\n    //   });\n    }\n    else if (type === 'drawing' || type === 'arrow') {\n      let modelStart = convertToSvgPoint([dragStartX, dragStartY], svg);\n      let modelEnd = convertToSvgPoint([overlay.offsetLeft, overlay.offsetTop], svg);\n      let modelDelta = {\n        x: modelEnd[0] - modelStart[0],\n        y: modelEnd[1] - modelStart[1]\n      };\n\n      // update annotation\n      annotation.lines.forEach((line, i) => {\n        let [x, y] = annotation.lines[i];\n        annotation.lines[i][0] = parseFloat(x) + modelDelta.x;\n        annotation.lines[i][1] = parseFloat(y) + modelDelta.y;\n      });\n\n      // replace old path with new one\n      target[0].parentNode.removeChild(target[0]);\n      appendChild(svg, annotation);\n    }\n\n    PDFJSAnnotate.getStoreAdapter().editAnnotation(documentId, annotationId, annotation);\n  });\n\n  setTimeout(() => {\n    isDragging = false;\n  }, 0);\n\n  overlay.style.background = '';\n  overlay.style.cursor = '';\n\n  document.removeEventListener('mousemove', handleDocumentMousemove);\n  document.removeEventListener('mouseup', handleDocumentMouseup);\n  enableUserSelect();\n}\n\n/**\n * Handle annotation.click event\n *\n * @param {Element} target The annotation element that was clicked\n */\nfunction handleAnnotationClick(target) {\n  createEditOverlay(target);\n}\n\n/**\n * Enable edit mode behavior.\n */\nexport function enableEdit() {\n  if (_enabled) {\n    return;\n  }\n\n  _enabled = true;\n  addEventListener('annotation:click', handleAnnotationClick);\n};\n\n/**\n * Disable edit mode behavior.\n */\nexport function disableEdit() {\n  destroyEditOverlay();\n\n  if (!_enabled) {\n    return;\n  }\n\n  _enabled = false;\n  removeEventListener('annotation:click', handleAnnotationClick);\n};\n\n","import PDFJSAnnotate from '../PDFJSAnnotate';\nimport { appendChild } from '../render/appendChild';\nimport {\n  disableUserSelect,\n  enableUserSelect,\n  findSVGAtPoint,\n  getMetadata,\n  convertToSvgPoint,\n  isInForbiddenArea\n} from './utils';\n\nlet _enabled = false;\nlet _candraw = false;\nlet _penSize;\nlet _penColor;\nlet path;\nlet lines = [];\n\n/**\n * Handle document.touchdown or document.pointerdown event\n * @param {PointerEvent} e The DOM event to be handled\n */\nfunction handleDocumentPointerdown(e) {\n  path = null;\n  lines = [];\n  _candraw = true;\n  if (isInForbiddenArea(e.x, e.y)) {\n    return;\n  }\n  /* if (!e.srcElement.classList.contains('annotationLayer')) {\n    return;\n  } */\n  e.preventDefault();\n}\n\n/**\n * Handle document.pointerup event\n *\n * @param {PointerEvent} e The DOM event to be handled\n */\nfunction handleDocumentPointerup(e) {\n  saveToStorage(e.clientX, e.clientY);\n}\n\nfunction saveToStorage(x, y) {\n  _candraw = false;\n  let svg;\n  if (lines.length > 1 && (svg = findSVGAtPoint(x, y))) {\n    let { documentId, pageNumber } = getMetadata(svg);\n    PDFJSAnnotate.getStoreAdapter().addAnnotation(documentId, pageNumber, {\n      type: 'drawing',\n      width: _penSize,\n      color: _penColor,\n      lines\n    }).then((annotation) => {\n      if (path) {\n        svg.removeChild(path);\n      }\n\n      appendChild(svg, annotation);\n    });\n  }\n}\n\n/**\n * Handle document.mousemove event\n *\n * @param {PointerEvent} e The DOM event to be handled\n */\nfunction handleDocumentPointermove(e) {\n  // if (!e.srcElement.classList.contains('annotationLayer')) {\n  //   return;\n  // }\n  if (_candraw) {\n    savePoint(e.clientX, e.clientY);\n  }\n}\n\n/**\n * Handle document.keyup event\n *\n * @param {KeyboardEvent} e The DOM event to be handled\n * } e The DOM event to be handled\n */\nfunction handleDocumentKeyup(e) {\n  // Cancel rect if Esc is pressed\n  if (e.keyCode === 27) {\n    lines = null;\n    path.parentNode.removeChild(path);\n    document.removeEventListener('pointermove', handleDocumentPointermove);\n    document.removeEventListener('pointerup', handleDocumentPointerup);\n  }\n}\n\n/**\n * Save a point to the line being drawn.\n *\n * @param {Number} x The x coordinate of the point\n * @param {Number} y The y coordinate of the point\n */\nfunction savePoint(x, y) {\n  let svg = findSVGAtPoint(x, y);\n  if (!svg) {\n    return;\n  }\n\n  let rect = svg.getBoundingClientRect();\n  let point = convertToSvgPoint([\n    x - rect.left,\n    y - rect.top\n  ], svg);\n  point[0] = point[0].toFixed(2);\n  point[1] = point[1].toFixed(2);\n  lines.push(point);\n\n  if (lines.length <= 1) {\n    return;\n  }\n\n  if (path) {\n    svg.removeChild(path);\n  }\n\n  path = appendChild(svg, {\n    type: 'drawing',\n    color: _penColor,\n    width: _penSize,\n    lines\n  });\n}\n\n/**\n * Set the attributes of the pen.\n *\n * @param {Number} penSize The size of the lines drawn by the pen, rounded to 2 decimal places\n * @param {String} penColor The color of the lines drawn by the pen\n */\nexport function setPen(penSize = 1, penColor = '000000') {\n  _penSize = Math.round(parseFloat(penSize) * 1e2) / 1e2;\n  _penColor = penColor;\n}\n\n/**\n * Return pen attributes of the pen\n *\n * @return {Object} Object with size and color\n */\nexport function getPen() {\n  return {\n    size: _penSize,\n    color: _penColor\n  };\n}\n\n/**\n * Enable the pen behavior\n */\nexport function enablePen() {\n  if (_enabled) {\n    return;\n  }\n\n  _enabled = true;\n  // Chrome and Firefox has different behaviors with how pen works, so we need different events.\n  document.addEventListener('pointerdown', handleDocumentPointerdown);\n  document.addEventListener('pointermove', handleDocumentPointermove);\n  document.addEventListener('pointerup', handleDocumentPointerup);\n\n  document.addEventListener('keyup', handleDocumentKeyup);\n  disableUserSelect();\n}\n\n/**\n * Disable the pen behavior\n */\nexport function disablePen() {\n  if (!_enabled) {\n    return;\n  }\n\n  _enabled = false;\n  document.removeEventListener('pointerdown', handleDocumentPointerdown);\n  document.removeEventListener('pointermove', handleDocumentPointermove);\n  document.removeEventListener('pointerup', handleDocumentPointerup);\n\n  document.removeEventListener('keyup', handleDocumentKeyup);\n  enableUserSelect();\n}\n","import PDFJSAnnotate from '../PDFJSAnnotate';\nimport { appendChild } from '../render/appendChild';\nimport {\n  disableUserSelect,\n  enableUserSelect,\n  findSVGAtPoint,\n  findSVGContainer,\n  getMetadata,\n  convertToSvgPoint,\n  convertToScreenPoint,\n  findAnnotationAtPoint\n} from './utils';\n\nlet _enabled = false;\nlet _penSize;\nlet _penColor;\nlet path;\nlet lines;\nlet originY;\nlet originX;\n\n/**\n * Handle document.mousedown event\n *\n * @param {Event} e The DOM event to be handled\n */\nfunction handleDocumentMousedown(e) {\n  let target = findAnnotationAtPoint(e.clientX, e.clientY);\n  if (target === null) {\n    return;\n  }\n\n  let type = target.getAttribute('data-pdf-annotate-type');\n  if (type !== 'circle' && type !== 'fillcircle' && type !== 'emptycircle') {\n    return;\n  }\n\n  let svg = findSVGContainer(target);\n  let { documentId } = getMetadata(svg);\n  let annotationId = target.getAttribute('data-pdf-annotate-id');\n\n  PDFJSAnnotate.getStoreAdapter().getAnnotation(documentId, annotationId).then((annotation) => {\n    if (annotation) {\n      path = null;\n      lines = [];\n\n      let point = convertToScreenPoint([\n        annotation.cx,\n        annotation.cy\n      ], svg);\n\n      let rect = svg.getBoundingClientRect();\n\n      originX = point[0] + rect.left;\n      originY = point[1] + rect.top;\n\n      document.addEventListener('mousemove', handleDocumentMousemove);\n      document.addEventListener('mouseup', handleDocumentMouseup);\n    }\n  });\n}\n\n/**\n * Handle document.mouseup event\n *\n * @param {Event} e The DOM event to be handled\n */\nfunction handleDocumentMouseup(e) {\n  let svg;\n  if (lines.length > 1 && (svg = findSVGAtPoint(e.clientX, e.clientY))) {\n    let { documentId, pageNumber } = getMetadata(svg);\n\n    PDFJSAnnotate.getStoreAdapter().addAnnotation(documentId, pageNumber, {\n      type: 'arrow',\n      width: _penSize,\n      color: _penColor,\n      lines\n    }).then((annotation) => {\n      if (path) {\n        svg.removeChild(path);\n      }\n\n      appendChild(svg, annotation);\n    });\n  }\n\n  document.removeEventListener('mousemove', handleDocumentMousemove);\n  document.removeEventListener('mouseup', handleDocumentMouseup);\n}\n\n/**\n * Handle document.mousemove event\n *\n * @param {Event} e The DOM event to be handled\n */\nfunction handleDocumentMousemove(e) {\n  let x = lines.length === 0 ? originX : e.clientX;\n  let y = lines.length === 0 ? originY : e.clientY;\n\n  savePoint(x, y);\n}\n\n/**\n * Handle document.keyup event\n *\n * @param {Event} e The DOM event to be handled\n */\nfunction handleDocumentKeyup(e) {\n  // Cancel rect if Esc is pressed\n  if (e.keyCode === 27) {\n    lines = null;\n    path.parentNode.removeChild(path);\n    document.removeEventListener('mousemove', handleDocumentMousemove);\n    document.removeEventListener('mouseup', handleDocumentMouseup);\n  }\n}\n\n/**\n * Save a point to the line being drawn.\n *\n * @param {Number} x The x coordinate of the point\n * @param {Number} y The y coordinate of the point\n */\nfunction savePoint(x, y) {\n  let svg = findSVGAtPoint(x, y);\n  if (!svg) {\n    return;\n  }\n\n  let rect = svg.getBoundingClientRect();\n  let point = convertToSvgPoint([\n    x - rect.left,\n    y - rect.top\n  ], svg);\n\n  if (lines.length < 2) {\n    lines.push(point);\n    return;\n  }\n  else {\n    lines[1] = point; // update end point\n  }\n\n  if (path) {\n    svg.removeChild(path);\n  }\n\n  path = appendChild(svg, {\n    type: 'arrow',\n    color: _penColor,\n    width: _penSize,\n    lines\n  });\n}\n\n/**\n * Set the attributes of the pen.\n *\n * @param {Number} penSize The size of the lines drawn by the pen\n * @param {String} penColor The color of the lines drawn by the pen\n */\nexport function setArrow(penSize = 10, penColor = '0000FF') {\n  _penSize = parseInt(penSize, 10);\n  _penColor = penColor;\n}\n\n/**\n * Enable the pen behavior\n */\nexport function enableArrow() {\n  if (_enabled) { return; }\n\n  _enabled = true;\n  document.addEventListener('mousedown', handleDocumentMousedown);\n  document.addEventListener('keyup', handleDocumentKeyup);\n  disableUserSelect();\n}\n\n/**\n * Disable the pen behavior\n */\nexport function disableArrow() {\n  if (!_enabled) { return; }\n\n  _enabled = false;\n  document.removeEventListener('mousedown', handleDocumentMousedown);\n  document.removeEventListener('keyup', handleDocumentKeyup);\n  enableUserSelect();\n}\n\n","import PDFJSAnnotate from '../PDFJSAnnotate';\nimport {\n  findAnnotationAtPoint,\n  getMetadata\n} from './utils';\n\nlet _canerase = false;\nlet previousPoint = null;\n\n/**\n *\n * @param {PointerEvent} e DOM event to handle\n */\nfunction handleDocumentDown(e) {\n  _canerase = true;\n  previousPoint = [e.clientX, e.clientY];\n}\n\n/**\n *\n * @param {PointerEvent} e DOM event to handle\n */\nfunction handleDocumentUp(e) {\n  _canerase = false;\n  erase(findAnnotationAtPoint(e.clientX, e.clientY));\n}\n\n/**\n *\n * @param {PointerEvent} e DOM event to handle\n */\nfunction handleDocumentMouseMove(e) {\n  if (!_canerase) {\n    return;\n  }\n\n  // This algorithm attempts to get the various points between the last\n  // PointerEvent and this one\n  let check = [];\n  let diffX = Math.abs(previousPoint[0] - e.clientX);\n  let diffY = Math.abs(previousPoint[1] - e.clientY);\n  if (diffX >= 1 || diffY >= 1) {\n    let maxSteps = Math.round(Math.max(diffX, diffY));\n    let subStepSize = Math.min(diffX, diffY) / maxSteps;\n    let smallerTest = diffX < diffY;\n    let startPoint = [\n      Math.min(previousPoint[0], e.clientX),\n      Math.min(previousPoint[1], e.clientY)\n    ];\n    for (let i = 0; i < maxSteps; i++) {\n      if (smallerTest) {\n        check.push([Math.round(startPoint[0] + (subStepSize * i)), Math.round(startPoint[1] + i)]);\n      }\n      else {\n        check.push([Math.round(startPoint[0] + i), Math.round(startPoint[1] + (subStepSize * i))]);\n      }\n    }\n  }\n  for (let point of check) {\n    erase(findAnnotationAtPoint(point[0], point[1]));\n  }\n  previousPoint = [e.clientX, e.clientY];\n}\n\nfunction erase(target) {\n  if (!_canerase) {\n    return;\n  }\n\n  if (target) {\n    let { documentId } = getMetadata(target.parentElement);\n    let annotationId = target.getAttribute('data-pdf-annotate-id');\n    PDFJSAnnotate.getStoreAdapter().deleteAnnotation(documentId, annotationId).then(() => {\n      let nodes = document.querySelectorAll(`[data-pdf-annotate-id=\"${annotationId}\"]`);\n      [...nodes].forEach((n) => {\n        n.parentNode.removeChild(n);\n      });\n    });\n  }\n}\n\nexport function enableEraser() {\n  document.addEventListener('pointermove', handleDocumentMouseMove);\n  document.addEventListener('pointerdown', handleDocumentDown);\n  document.addEventListener('pointerup', handleDocumentUp);\n}\n\nexport function disableEraser() {\n  document.removeEventListener('pointermove', handleDocumentMouseMove);\n  document.removeEventListener('pointerdown', handleDocumentDown);\n  document.removeEventListener('pointerup', handleDocumentUp);\n}\n","import PDFJSAnnotate from '../PDFJSAnnotate';\nimport { appendChild } from '../render/appendChild';\nimport {\n  BORDER_COLOR,\n  findSVGAtPoint,\n  getMetadata,\n  scaleDown\n} from './utils';\n\nlet _enabled = false;\nlet input;\n\n/**\n * Handle document.mouseup event\n *\n * @param {Event} e The DOM event to be handled\n */\nfunction handleDocumentMouseup(e) {\n  if (input || !findSVGAtPoint(e.clientX, e.clientY)) {\n    return;\n  }\n\n  input = document.createElement('input');\n  input.setAttribute('id', 'pdf-annotate-point-input');\n  input.setAttribute('placeholder', 'Enter comment');\n  input.style.border = `3px solid ${BORDER_COLOR}`;\n  input.style.borderRadius = '3px';\n  input.style.position = 'absolute';\n  input.style.top = `${e.clientY}px`;\n  input.style.left = `${e.clientX}px`;\n\n  input.addEventListener('blur', handleInputBlur);\n  input.addEventListener('keyup', handleInputKeyup);\n\n  document.body.appendChild(input);\n  input.focus();\n}\n\n/**\n * Handle input.blur event\n */\nfunction handleInputBlur() {\n  savePoint();\n}\n\n/**\n * Handle input.keyup event\n *\n * @param {Event} e The DOM event to handle\n */\nfunction handleInputKeyup(e) {\n  if (e.keyCode === 27) {\n    closeInput();\n  }\n  else if (e.keyCode === 13) {\n    savePoint();\n  }\n}\n\n/**\n * Save a new point annotation from input\n */\nfunction savePoint() {\n  if (input.value.trim().length > 0) {\n    let clientX = parseInt(input.style.left, 10);\n    let clientY = parseInt(input.style.top, 10);\n    let content = input.value.trim();\n    let svg = findSVGAtPoint(clientX, clientY);\n    if (!svg) {\n      return;\n    }\n\n    let rect = svg.getBoundingClientRect();\n    let { documentId, pageNumber } = getMetadata(svg);\n    let annotation = Object.assign({\n      type: 'point'\n    }, scaleDown(svg, {\n      x: clientX - rect.left,\n      y: clientY - rect.top\n    }));\n\n    PDFJSAnnotate.getStoreAdapter().addAnnotation(documentId, pageNumber, annotation)\n      .then((annotation) => {\n        PDFJSAnnotate.getStoreAdapter().addComment(\n          documentId,\n          annotation.uuid,\n          content\n        );\n\n        appendChild(svg, annotation);\n      });\n  }\n\n  closeInput();\n}\n\n/**\n * Close the input element\n */\nfunction closeInput() {\n  input.removeEventListener('blur', handleInputBlur);\n  input.removeEventListener('keyup', handleInputKeyup);\n  document.body.removeChild(input);\n  input = null;\n}\n\n/**\n * Enable point annotation behavior\n */\nexport function enablePoint() {\n  if (_enabled) { return; }\n\n  _enabled = true;\n  document.addEventListener('mouseup', handleDocumentMouseup);\n}\n\n/**\n * Disable point annotation behavior\n */\nexport function disablePoint() {\n  if (!_enabled) { return; }\n\n  _enabled = false;\n  document.removeEventListener('mouseup', handleDocumentMouseup);\n}\n\n","import PDFJSAnnotate from '../PDFJSAnnotate';\nimport config from '../config';\nimport { appendChild } from '../render/appendChild';\nimport {\n  BORDER_COLOR,\n  disableUserSelect,\n  enableUserSelect,\n  findSVGAtPoint,\n  getMetadata,\n  convertToSvgRect,\n  isInForbiddenArea\n} from './utils';\n\nlet _enabled = false;\nlet _type;\nlet overlay;\nlet originY;\nlet originX;\n\n/**\n * Get the current window selection as rects\n *\n * @return {Array} An Array of rects\n */\nfunction getSelectionRects() {\n  try {\n    let selection = window.getSelection();\n    let range = selection.getRangeAt(0);\n    let rects = range.getClientRects();\n\n    if (rects.length > 0 &&\n        rects[0].width > 0 &&\n        rects[0].height > 0) {\n      return rects;\n    }\n  }\n  catch (e) {}\n\n  return null;\n}\n\n/**\n * Handle document.mousedown event\n *\n * @param {Event} e The DOM event to handle\n */\nfunction handleDocumentMousedown(e) {\n  let svg;\n  if (_type !== 'area' || !(svg = findSVGAtPoint(e.clientX, e.clientY))) {\n    return;\n  }\n\n  let rect = svg.getBoundingClientRect();\n  originY = e.clientY;\n  originX = e.clientX;\n\n  overlay = document.createElement('div');\n  overlay.style.position = 'absolute';\n  overlay.style.top = `${originY - rect.top}px`;\n  overlay.style.left = `${originX - rect.left}px`;\n  overlay.style.border = `3px solid ${BORDER_COLOR}`;\n  overlay.style.borderRadius = '3px';\n  svg.parentNode.appendChild(overlay);\n\n  document.addEventListener('mousemove', handleDocumentMousemove);\n  disableUserSelect();\n}\n\n/**\n * Handle document.mousemove event\n *\n * @param {Event} e The DOM event to handle\n */\nfunction handleDocumentMousemove(e) {\n  let svg = overlay.parentNode.querySelector(config.annotationSvgQuery());\n  let rect = svg.getBoundingClientRect();\n\n  if (originX + (e.clientX - originX) < rect.right) {\n    overlay.style.width = `${e.clientX - originX}px`;\n  }\n\n  if (originY + (e.clientY - originY) < rect.bottom) {\n    overlay.style.height = `${e.clientY - originY}px`;\n  }\n}\n\n/**\n * Handle document.mouseup event\n *\n * @param {Event} e The DOM event to handle\n */\nfunction handleDocumentMouseup(e) {\n  let rects;\n  if (isInForbiddenArea(e.clientX, e.clientY)) {\n    return;\n  }\n  if (_type !== 'area' && (rects = getSelectionRects())) {\n    saveRect(_type, [...rects].map((r) => {\n      return {\n        top: r.top,\n        left: r.left,\n        width: r.width,\n        height: r.height\n      };\n    }));\n  }\n  else if (_type === 'area' && overlay) {\n    let svg = overlay.parentNode.querySelector(config.annotationSvgQuery());\n    let rect = svg.getBoundingClientRect();\n    saveRect(_type, [{\n      top: parseInt(overlay.style.top, 10) + rect.top,\n      left: parseInt(overlay.style.left, 10) + rect.left,\n      width: parseInt(overlay.style.width, 10),\n      height: parseInt(overlay.style.height, 10)\n    }]);\n\n    overlay.parentNode.removeChild(overlay);\n    overlay = null;\n\n    document.removeEventListener('mousemove', handleDocumentMousemove);\n    enableUserSelect();\n  }\n}\n\n/**\n * Handle document.keyup event\n *\n * @param {Event} e The DOM event to handle\n */\nfunction handleDocumentKeyup(e) {\n  // Cancel rect if Esc is pressed\n  if (e.keyCode === 27) {\n    let selection = window.getSelection();\n    selection.removeAllRanges();\n    if (overlay && overlay.parentNode) {\n      overlay.parentNode.removeChild(overlay);\n      overlay = null;\n      document.removeEventListener('mousemove', handleDocumentMousemove);\n    }\n  }\n}\n\n/**\n * Save a rect annotation\n *\n * @param {String} type The type of rect (area, highlight, strikeout)\n * @param {Array} rects The rects to use for annotation\n * @param {String} color The color of the rects\n */\nfunction saveRect(type, rects, color) {\n  let svg = findSVGAtPoint(rects[0].left, rects[0].top);\n  let annotation;\n\n  if (!svg) {\n    return;\n  }\n\n  let boundingRect = svg.getBoundingClientRect();\n\n  if (!color) {\n    if (type === 'highlight') {\n      color = 'FFFF00';\n    }\n    else if (type === 'strikeout') {\n      color = 'FF0000';\n    }\n  }\n\n  // Initialize the annotation\n  annotation = {\n    type,\n    color,\n    rectangles: [...rects].map((r) => {\n      let offset = 0;\n\n      if (type === 'strikeout') {\n        offset = r.height / 2;\n      }\n\n      return convertToSvgRect({\n        y: (r.top + offset) - boundingRect.top,\n        x: r.left - boundingRect.left,\n        width: r.width,\n        height: r.height\n      }, svg);\n    }).filter((r) => r.width > 0 && r.height > 0 && r.x > -1 && r.y > -1)\n  };\n\n  // Short circuit if no rectangles exist\n  if (annotation.rectangles.length === 0) {\n    return;\n  }\n\n  // Special treatment for area as it only supports a single rect\n  if (type === 'area') {\n    let rect = annotation.rectangles[0];\n    delete annotation.rectangles;\n    annotation.x = rect.x;\n    annotation.y = rect.y;\n    annotation.width = rect.width;\n    annotation.height = rect.height;\n  }\n\n  let { documentId, pageNumber } = getMetadata(svg);\n\n  // Add the annotation\n  PDFJSAnnotate.getStoreAdapter().addAnnotation(documentId, pageNumber, annotation)\n    .then((annotation) => {\n      appendChild(svg, annotation);\n    });\n}\n\n/**\n * Enable rect behavior\n *\n * @param {String} type The selected tool type\n */\nexport function enableRect(type) {\n  _type = type;\n\n  if (_enabled) { return; }\n\n  _enabled = true;\n  document.addEventListener('mouseup', handleDocumentMouseup);\n  document.addEventListener('mousedown', handleDocumentMousedown);\n  document.addEventListener('keyup', handleDocumentKeyup);\n}\n\n/**\n * Disable rect behavior\n */\nexport function disableRect() {\n  if (!_enabled) { return; }\n\n  _enabled = false;\n  document.removeEventListener('mouseup', handleDocumentMouseup);\n  document.removeEventListener('mousedown', handleDocumentMousedown);\n  document.removeEventListener('keyup', handleDocumentKeyup);\n}\n\n","import PDFJSAnnotate from '../PDFJSAnnotate';\nimport { appendChild } from '../render/appendChild';\nimport {\n  findSVGAtPoint,\n  getMetadata,\n  convertToSvgPoint\n} from './utils';\n\nlet _enabled = false;\nlet _type;\nlet _circleRadius = 10;\nlet _circleColor = '0000FF';\n\n/**\n * Set the attributes of the pen.\n *\n * @param {Number} circleRadius The radius of the circle\n * @param {String} circleColor The color of the circle\n */\nexport function setCircle(circleRadius = 10, circleColor = '0000FF') {\n  _circleRadius = parseInt(circleRadius, 10);\n  _circleColor = circleColor;\n}\n\n/**\n * Handle document.mouseup event\n *\n * @param {Event} e The DOM event to handle\n */\nfunction handleDocumentMouseup(e) {\n  let svg = findSVGAtPoint(e.clientX, e.clientY);\n  if (!svg) {\n    return;\n  }\n  let rect = svg.getBoundingClientRect();\n  saveCircle(svg, _type, {\n    x: e.clientX - rect.left,\n    y: e.clientY - rect.top\n  }, _circleRadius, _circleColor);\n}\n\n/**\n * Save a circle annotation\n *\n * @param {SVGElement} svg The annotation layer\n * @param {String} type The type of circle (circle, emptycircle, fillcircle)\n * @param {Object} pt The point to use for annotation\n * @param {float} radius The radius of circle\n * @param {String} color The color of the rects\n */\nfunction saveCircle(svg, type, pt, radius, color) {\n  // Initialize the annotation\n  let svg_pt = convertToSvgPoint([ pt.x, pt.y ], svg);\n  let annotation = {\n    type,\n    color,\n    cx: svg_pt[0],\n    cy: svg_pt[1],\n    r: radius\n  };\n\n  let { documentId, pageNumber } = getMetadata(svg);\n\n  // Add the annotation\n  PDFJSAnnotate.getStoreAdapter().addAnnotation(documentId, pageNumber, annotation)\n    .then((annotation) => {\n      appendChild(svg, annotation);\n    });\n}\n\n/**\n * Enable circle behavior\n *\n * @param {String} type The selected tool type\n */\nexport function enableCircle(type) {\n  _type = type;\n\n  if (_enabled) { return; }\n\n  _enabled = true;\n  document.addEventListener('mouseup', handleDocumentMouseup);\n}\n\n/**\n * Disable circle behavior\n */\nexport function disableCircle() {\n  if (!_enabled) { return; }\n\n  _enabled = false;\n  document.removeEventListener('mouseup', handleDocumentMouseup);\n}\n\nexport function addCircle(type, e) {\n  let oldType = _type;\n  _type = type;\n  handleDocumentMouseup(e);\n  _type = oldType;\n}\n","import PDFJSAnnotate from '../PDFJSAnnotate';\nimport { appendChild } from '../render/appendChild';\nimport {\n  BORDER_COLOR,\n  findSVGAtPoint,\n  getMetadata,\n  convertToSvgPoint\n} from './utils';\n\nlet _enabled = false;\nlet input;\nlet _textSize;\nlet _textColor;\n\n/**\n * Handle document.mouseup event\n *\n * @param {Event} e The DOM event to handle\n */\nfunction handleDocumentMouseup(e) {\n  if (input || !findSVGAtPoint(e.clientX, e.clientY)) {\n    return;\n  }\n  // if (!e.srcElement.classList.contains('annotationLayer')) {\n  //   return;\n  // }\n  input = document.createElement('textarea');\n  input.setAttribute('id', 'pdf-annotate-text-input');\n  input.setAttribute('placeholder', 'Enter text... SHIFT + ENTER for new line');\n  input.style.border = `3px solid ${BORDER_COLOR}`;\n  input.style.borderRadius = '3px';\n  input.style.position = 'absolute';\n  input.style.top = `${e.clientY}px`;\n  input.style.left = `${e.clientX}px`;\n  input.style.fontSize = `${_textSize}px`;\n  input.style.zIndex = '41';\n  input.addEventListener('blur', handleInputBlur);\n  input.addEventListener('keyup', handleInputKeyup);\n\n  document.body.appendChild(input);\n  input.focus();\n}\n\n/**\n * Handle input.blur event\n */\nfunction handleInputBlur() {\n  saveText();\n}\n\n/**\n * Handle input.keyup event\n *\n * @param {Event} e The DOM event to handle\n */\nfunction handleInputKeyup(e) {\n  if (e.keyCode === 27) {\n    closeInput();\n  }\n  else if (e.keyCode === 13 && !e.shiftKey) {\n    saveText();\n  }\n}\n\n/**\n * Save a text annotation from input\n */\nfunction saveText() {\n  let value = (input.value) ? input.value.replace(/ +$/, '') : '';\n  if (value.length > 0) {\n    let clientX = parseInt(input.style.left, 10);\n    let clientY = parseInt(input.style.top, 10);\n    let svg = findSVGAtPoint(clientX, clientY);\n    if (!svg) {\n      return;\n    }\n    let height = _textSize;\n    let { documentId, pageNumber, viewport } = getMetadata(svg);\n    let scale = 1 / viewport.scale;\n    let rect = svg.getBoundingClientRect();\n    let pt = convertToSvgPoint([\n      clientX - rect.left,\n      clientY - rect.top + height], svg, viewport);\n    let annotation = {\n      type: 'textbox',\n      size: _textSize * scale,\n      color: _textColor,\n      content: value,\n      x: pt[0],\n      y: pt[1],\n      rotation: -viewport.rotation\n    };\n\n    PDFJSAnnotate.getStoreAdapter().addAnnotation(documentId, pageNumber, annotation)\n      .then((annotation) => {\n        appendChild(svg, annotation);\n      });\n  }\n\n  closeInput();\n}\n\n/**\n * Close the input\n */\nfunction closeInput() {\n  if (input) {\n    input.removeEventListener('blur', handleInputBlur);\n    input.removeEventListener('keyup', handleInputKeyup);\n    document.body.removeChild(input);\n    input = null;\n  }\n}\n\n/**\n * Set the text attributes\n *\n * @param {Number} textSize The size of the text\n * @param {String} textColor The color of the text\n */\nexport function setText(textSize = 12, textColor = '000000') {\n  _textSize = parseInt(textSize, 10);\n  _textColor = textColor;\n}\n\n/**\n * Enable text behavior\n */\nexport function enableText() {\n  if (_enabled) {\n    return;\n  }\n\n  _enabled = true;\n  document.addEventListener('mouseup', handleDocumentMouseup);\n}\n\n/**\n * Disable text behavior\n */\nexport function disableText() {\n  if (!_enabled) { return; }\n\n  _enabled = false;\n  document.removeEventListener('mouseup', handleDocumentMouseup);\n}\n\n","/**\n * Create a node that is only visible to screen readers\n *\n * @param {String} content The text content that should be read by screen reader\n * @param {String} [annotationId] The ID of the annotation assocaited\n * @return {Element} An Element that is only visible to screen readers\n */\nexport default function createScreenReaderOnly(content, annotationId) {\n  let node = document.createElement('div');\n  let text = document.createTextNode(content);\n  node.appendChild(text);\n  node.setAttribute('id', `pdf-annotate-screenreader-${annotationId}`);\n  node.style.position = 'absolute';\n  node.style.left = '-10000px';\n  node.style.top = 'auto';\n  node.style.width = '1px';\n  node.style.height = '1px';\n  node.style.overflow = 'hidden';\n  return node;\n}\n","import config from '../config';\nimport {\n  pointIntersectsRect,\n  scaleUp,\n  scaleDown\n} from '../UI/utils';\n\n/**\n * Insert an element at a point within the document.\n * This algorithm will only insert within an element amidst it's text content.\n *\n * @param {Element} el The element to be inserted\n * @param {Number} x The x coordinate of the point\n * @param {Number} y The y coordinate of the point\n * @param {Number} pageNumber The page number to limit elements to\n * @param {Boolean} insertBefore Whether the element is to be inserted before or after x\n * @return {Boolean} True if element was able to be inserted, otherwise false\n */\nexport default function insertElementWithinElement(el, x, y, pageNumber, insertBefore) {\n  const OFFSET_ADJUST = 2;\n\n  // If inserting before adjust `x` by looking for element a few px to the right\n  // Otherwise adjust a few px to the left\n  // This is to allow a little tolerance by searching within the box, instead\n  // of getting a false negative by testing right on the border.\n  x = Math.max(x + (OFFSET_ADJUST * (insertBefore ? 1 : -1)), 0);\n\n  let node = textLayerElementFromPoint(x, y + OFFSET_ADJUST, pageNumber);\n  if (!node) {\n    return false;\n  }\n\n  // Now that node has been found inverse the adjustment for `x`.\n  // This is done to accomodate tolerance by cutting off on the outside of the\n  // text boundary, instead of missing a character by cutting off within.\n  x = x + (OFFSET_ADJUST * (insertBefore ? -1 : 1));\n\n  let svg = document.querySelector(`svg[data-pdf-annotate-page=\"${pageNumber}\"]`);\n  let left = scaleDown(svg, {left: node.getBoundingClientRect().left}).left - svg.getBoundingClientRect().left;\n  let temp = node.cloneNode(true);\n  let head = temp.innerHTML.split('');\n  let tail = [];\n\n  // Insert temp off screen\n  temp.style.position = 'absolute';\n  temp.style.top = '-10000px';\n  temp.style.left = '-10000px';\n  document.body.appendChild(temp);\n\n  while (head.length) {\n    // Don't insert within HTML tags\n    if (head[head.length - 1] === '>') {\n      while (head.length) {\n        tail.unshift(head.pop());\n        if (tail[0] === '<') {\n          break;\n        }\n      }\n    }\n\n    // Check if width of temp based on current head value satisfies x\n    temp.innerHTML = head.join('');\n    let width = scaleDown(svg, {width: temp.getBoundingClientRect().width}).width;\n    if (left + width <= x) {\n      break;\n    }\n    tail.unshift(head.pop());\n  }\n\n  // Update original node with new markup, including element to be inserted\n  node.innerHTML = head.join('') + el.outerHTML + tail.join('');\n  temp.parentNode.removeChild(temp);\n\n  return true;\n}\n\n/**\n * Get a text layer element at a given point on a page\n *\n * @param {Number} x The x coordinate of the point\n * @param {Number} y The y coordinate of the point\n * @param {Number} pageNumber The page to limit elements to\n * @return {Element} First text layer element found at the point\n */\nfunction textLayerElementFromPoint(x, y, pageNumber) {\n  let svg = document.querySelector(`svg[data-pdf-annotate-page=\"${pageNumber}\"]`);\n  let rect = svg.getBoundingClientRect();\n  y = scaleUp(svg, {y}).y + rect.top;\n  x = scaleUp(svg, {x}).x + rect.left;\n  return [...svg.parentNode.querySelectorAll(config.textClassQuery() + ' [data-canvas-width]')].filter((el) => {\n    return pointIntersectsRect(x, y, el.getBoundingClientRect());\n  })[0];\n}\n","import config from '../config';\nimport insertElementWithinElement from './insertElementWithinElement';\nimport { pointIntersectsRect, scaleUp } from '../UI/utils';\n\n/**\n * Insert an element at a point within the document.\n * This algorithm will try to insert between elements if possible.\n * It will however use `insertElementWithinElement` if it is more accurate.\n *\n * @param {Element} el The element to be inserted\n * @param {Number} x The x coordinate of the point\n * @param {Number} y The y coordinate of the point\n * @param {Number} pageNumber The page number to limit elements to\n * @return {Boolean} True if element was able to be inserted, otherwise false\n */\nexport default function insertElementWithinChildren(el, x, y, pageNumber) {\n  // Try and use most accurate method of inserting within an element\n  if (insertElementWithinElement(el, x, y, pageNumber, true)) {\n    return true;\n  }\n\n  // Fall back to inserting between elements\n  let svg = document.querySelector(`svg[data-pdf-annotate-page=\"${pageNumber}\"]`);\n  let rect = svg.getBoundingClientRect();\n  let nodes = [...svg.parentNode.querySelectorAll(config.textClassQuery() + ' > div')];\n\n  y = scaleUp(svg, {y}).y + rect.top;\n  x = scaleUp(svg, {x}).x + rect.left;\n\n  // Find the best node to insert before\n  for (let i = 0, l = nodes.length; i < l; i++) {\n    let n = nodes[i];\n    let r = n.getBoundingClientRect();\n    if (y <= r.top) {\n      n.parentNode.insertBefore(el, n);\n      return true;\n    }\n  }\n\n  // If all else fails try to append to the bottom\n  let textLayer = svg.parentNode.querySelector(config.textClassQuery());\n  if (textLayer) {\n    let textRect = textLayer.getBoundingClientRect();\n    if (pointIntersectsRect(x, y, textRect)) {\n      textLayer.appendChild(el);\n      return true;\n    }\n  }\n\n  return false;\n}\n","/**\n * Insert a comment into the DOM to be available by screen reader\n *\n * @param {Object} comment The comment to be inserted\n */\nexport default function insertScreenReaderComment(comment) {\n  if (!comment) {\n    return;\n  }\n\n  let list = document.querySelector(`#pdf-annotate-screenreader-${comment.annotation} ol`);\n  if (list) {\n    let item = document.createElement('li');\n    item.setAttribute('id', `pdf-annotate-screenreader-comment-${comment.uuid}`);\n    item.appendChild(document.createTextNode(`${comment.content}`));\n    list.appendChild(item);\n  }\n}\n","import PDFJSAnnotate from '../PDFJSAnnotate';\nimport insertScreenReaderComment from './insertScreenReaderComment';\n\n/**\n * Insert the comments into the DOM to be available by screen reader\n *\n * Example output:\n *   <div class=\"screenReaderOnly\">\n *    <div>Begin highlight 1</div>\n *    <ol aria-label=\"Comments\">\n *      <li>Foo</li>\n *      <li>Bar</li>\n *      <li>Baz</li>\n *      <li>Qux</li>\n *    </ol>\n *  </div>\n *  <div>Some highlighted text goes here...</div>\n *  <div class=\"screenReaderOnly\">End highlight 1</div>\n *\n * NOTE: `screenReaderOnly` is not a real class, just used for brevity\n *\n * @param {String} documentId The ID of the document\n * @param {String} annotationId The ID of the annotation\n * @param {Array} [comments] Optionally preloaded comments to be rendered\n * @return {Promise} Promise that once has comments, render them for screen reader\n */\nexport default function renderScreenReaderComments(documentId, annotationId, comments) {\n  let promise;\n\n  if (Array.isArray(comments)) {\n    promise = Promise.resolve(comments);\n  }\n  else {\n    promise = PDFJSAnnotate.getStoreAdapter().getComments(documentId, annotationId);\n  }\n\n  return promise.then((comments) => {\n    // Node needs to be found by querying DOM as it may have been inserted as innerHTML\n    // leaving `screenReaderNode` as an invalid reference (see `insertElementWithinElement`).\n    let node = document.getElementById(`pdf-annotate-screenreader-${annotationId}`);\n    if (node) {\n      let list = document.createElement('ol');\n      list.setAttribute('id', `pdf-annotate-screenreader-comment-list-${annotationId}`);\n      list.setAttribute('aria-label', 'Comments');\n      node.appendChild(list);\n      comments.forEach(insertScreenReaderComment);\n    }\n  });\n}\n","import createScreenReaderOnly from './createScreenReaderOnly';\nimport insertElementWithinChildren from './insertElementWithinChildren';\nimport insertElementWithinElement from './insertElementWithinElement';\nimport renderScreenReaderComments from './renderScreenReaderComments';\n\n// Annotation types that support comments\nconst COMMENT_TYPES = ['highlight', 'point', 'area', 'circle', 'emptycircle', 'fillcircle'];\n\n/**\n * Insert a hint into the DOM for screen readers for a specific annotation.\n *\n * @param {Object} annotation The annotation to insert a hint for\n * @param {Number} num The number of the annotation out of all annotations of the same type\n */\nexport default function insertScreenReaderHint(annotation, num = 0) {\n  switch (annotation.type) {\n    case 'highlight':\n    case 'strikeout':\n      let rects = annotation.rectangles;\n      let first = rects[0];\n      let last = rects[rects.length - 1];\n\n      insertElementWithinElement(\n        createScreenReaderOnly(`Begin ${annotation.type} annotation ${num}`, annotation.uuid),\n        first.x, first.y, annotation.page, true\n      );\n\n      insertElementWithinElement(\n        createScreenReaderOnly(`End ${annotation.type} annotation ${num}`, `${annotation.uuid}-end`),\n        last.x + last.width, last.y, annotation.page, false\n      );\n      break;\n\n    case 'textbox':\n    case 'point':\n      let text = annotation.type === 'textbox' ? ` (content: ${annotation.content})` : '';\n\n      insertElementWithinChildren(\n        createScreenReaderOnly(`${annotation.type} annotation ${num}${text}`, annotation.uuid),\n        annotation.x, annotation.y, annotation.page\n      );\n      break;\n\n    case 'drawing':\n    case 'area':\n      let x = typeof annotation.x !== 'undefined' ? annotation.x : annotation.lines[0][0];\n      let y = typeof annotation.y !== 'undefined' ? annotation.y : annotation.lines[0][1];\n\n      insertElementWithinChildren(\n        createScreenReaderOnly(`Unlabeled drawing`, annotation.uuid),\n        x, y, annotation.page\n      );\n      break;\n\n    case 'circle':\n    case 'fillcircle':\n    case 'emptycircle':\n      let x2 = typeof annotation.cx !== 'undefined' ? annotation.cx : annotation.lines[0][0];\n      let y2 = typeof annotation.cy !== 'undefined' ? annotation.cy : annotation.lines[0][1];\n\n      insertElementWithinChildren(\n        createScreenReaderOnly(`Unlabeled drawing`, annotation.uuid),\n        x2, y2, annotation.page\n      );\n      break;\n  }\n\n  // Include comments in screen reader hint\n  if (COMMENT_TYPES.includes(annotation.type)) {\n    renderScreenReaderComments(annotation.documentId, annotation.uuid);\n  }\n}\n","import renderScreenReaderHints from './renderScreenReaderHints';\nimport insertScreenReaderComment from './insertScreenReaderComment';\nimport renderScreenReaderComments from './renderScreenReaderComments';\nimport { addEventListener } from '../UI/event';\nimport PDFJSAnnotate from '../PDFJSAnnotate';\n\n/**\n * Initialize the event handlers for keeping screen reader hints synced with data\n */\nexport default function initEventHandlers() {\n  addEventListener('annotation:add', (documentId, pageNumber, annotation) => {\n    reorderAnnotationsByType(documentId, pageNumber, annotation.type);\n  });\n  addEventListener('annotation:edit', (documentId, annotationId, annotation) => {\n    reorderAnnotationsByType(documentId, annotation.page, annotation.type);\n  });\n  addEventListener('annotation:delete', removeAnnotation);\n  addEventListener('comment:add', insertComment);\n  addEventListener('comment:delete', removeComment);\n}\n\n/**\n * Reorder the annotation numbers by annotation type\n *\n * @param {String} documentId The ID of the document\n * @param {Number} pageNumber The page number of the annotations\n * @param {Strig} type The annotation type\n */\nfunction reorderAnnotationsByType(documentId, pageNumber, type) {\n  PDFJSAnnotate.getStoreAdapter().getAnnotations(documentId, pageNumber)\n    .then((annotations) => {\n      return annotations.annotations.filter((a) => {\n        return a.type === type;\n      });\n    })\n    .then((annotations) => {\n      annotations.forEach((a) => {\n        removeAnnotation(documentId, a.uuid);\n      });\n\n      return annotations;\n    })\n    .then(renderScreenReaderHints);\n}\n\n/**\n * Remove the screen reader hint for an annotation\n *\n * @param {String} documentId The ID of the document\n * @param {String} annotationId The Id of the annotation\n */\nfunction removeAnnotation(documentId, annotationId) {\n  removeElementById(`pdf-annotate-screenreader-${annotationId}`);\n  removeElementById(`pdf-annotate-screenreader-${annotationId}-end`);\n}\n\n/**\n * Insert a screen reader hint for a comment\n *\n * @param {String} documentId The ID of the document\n * @param {String} annotationId The ID of tha assocated annotation\n * @param {Object} comment The comment to insert a hint for\n */\nfunction insertComment(documentId, annotationId, comment) {\n  let list = document.querySelector(`pdf-annotate-screenreader-comment-list-${annotationId}`);\n  let promise;\n\n  if (!list) {\n    promise = renderScreenReaderComments(documentId, annotationId, []).then(() => {\n      list = document.querySelector(`pdf-annotate-screenreader-comment-list-${annotationId}`);\n      return true;\n    });\n  }\n  else {\n    promise = Promise.resolve(true);\n  }\n\n  promise.then(() => {\n    insertScreenReaderComment(comment);\n  });\n}\n\n/**\n * Remove a screen reader hint for a comment\n *\n * @param {String} documentId The ID of the document\n * @param {String} commentId The ID of the comment\n */\nfunction removeComment(documentId, commentId) {\n  removeElementById(`pdf-annotate-screenreader-comment-${commentId}`);\n}\n\n/**\n * Remove an element from the DOM by it's ID if it exists\n *\n * @param {String} elementId The ID of the element to be removed\n */\nfunction removeElementById(elementId) {\n  let el = document.getElementById(elementId);\n  if (el) {\n    el.parentNode.removeChild(el);\n  }\n}\n","import insertScreenReaderHint from './insertScreenReaderHint';\nimport initEventHandlers from './initEventHandlers';\n\n// TODO This is not the right place for this to live\ninitEventHandlers();\n\n/**\n * Insert hints into the DOM for screen readers.\n *\n * @param {Array} annotations The annotations that hints are inserted for\n */\nexport default function renderScreenReaderHints(annotations) {\n  annotations = Array.isArray(annotations) ? annotations : [];\n\n  // Insert hints for each type\n  Object.keys(SORT_TYPES).forEach((type) => {\n    let sortBy = SORT_TYPES[type];\n    annotations\n      .filter((a) => a.type === type)\n      .sort(sortBy)\n      .forEach((a, i) => insertScreenReaderHint(a, i + 1));\n  });\n}\n\n// Sort annotations first by y, then by x.\n// This allows hints to be injected in the order they appear,\n// which makes numbering them easier.\nfunction sortByPoint(a, b) {\n  if (a.y < b.y) {\n    return a.x - b.x;\n  }\n  else {\n    return 1;\n  }\n}\n\n// Sort annotation by it's first rectangle\nfunction sortByRectPoint(a, b) {\n  return sortByPoint(a.rectangles[0], b.rectangles[0]);\n}\n\n// Sort annotation by it's first line\nfunction sortByLinePoint(a, b) {\n  let lineA = a.lines[0];\n  let lineB = b.lines[0];\n  return sortByPoint(\n    {x: lineA[0], y: lineA[1]},\n    {x: lineB[0], y: lineB[1]}\n  );\n}\n\n// Arrange supported types and associated sort methods\nconst SORT_TYPES = {\n  'highlight': sortByRectPoint,\n  'strikeout': sortByRectPoint,\n  'drawing': sortByLinePoint,\n  'textbox': sortByPoint,\n  'point': sortByPoint,\n  'area': sortByPoint\n};\n\n","import PDFJSAnnotate from '../PDFJSAnnotate';\nimport config from '../config';\nimport renderScreenReaderHints from '../a11y/renderScreenReaderHints';\n\n// Template for creating a new page\nconst PAGE_TEMPLATE = `\n  <div style=\"visibility: hidden;\" class=\"page\" data-loaded=\"false\">\n    <div class=\"canvasWrapper\">\n      <canvas></canvas>\n    </div>\n    <svg class=\"` + config.annotationLayerName + `\"></svg>\n    <div class=\"` + config.textLayerName + `\"></div>\n  </div>\n`;\nlet eventBus = null;\n\nfunction getGlobalEventBus(dispatchToDOM = false) {\n  if (!eventBus) {\n    eventBus = new pdfjsViewer.EventBus({\n      dispatchToDOM\n    });\n  }\n  return eventBus;\n}\n\n/**\n * Create a new page to be appended to the DOM.\n *\n * @param {Number} pageNumber The page number that is being created\n * @return {HTMLElement} The page container element\n */\nexport function createPage(pageNumber) {\n  let temp = document.createElement('div');\n  temp.innerHTML = PAGE_TEMPLATE;\n\n  let page = temp.children[0];\n  let canvas = page.querySelector('canvas');\n\n  page.setAttribute('id', `pageContainer${pageNumber}`);\n  page.setAttribute('data-page-number', pageNumber);\n\n  canvas.mozOpaque = true;\n  canvas.setAttribute('id', `page${pageNumber}`);\n\n  return page;\n}\n\n/**\n * Render a page that has already been created.\n *\n * @param {Number} pageNumber The page number to be rendered\n * @param {Object} renderOptions The options for rendering\n * @return {Promise} Settled once rendering has completed\n *  A settled Promise will be either:\n *    - fulfilled: [pdfPage, annotations]\n *    - rejected: Error\n */\nexport function renderPage(pageNumber, renderOptions) {\n  let {\n    documentId,\n    pdfDocument,\n    scale,\n    rotate\n  } = renderOptions;\n\n  // Load the page and annotations\n  return Promise.all([\n    pdfDocument.getPage(pageNumber),\n    PDFJSAnnotate.getAnnotations(documentId, pageNumber)\n  ]).then(([pdfPage, annotations]) => {\n    let page = document.getElementById(`pageContainer${pageNumber}`);\n    let svg = page.querySelector(config.annotationClassQuery());\n    let canvas = page.querySelector('.canvasWrapper canvas');\n    let canvasContext = canvas.getContext('2d', {alpha: false});\n    let totalRotation = (rotate + pdfPage.rotate) % 360;\n    let viewport = pdfPage.getViewport({scale: scale, rotation: totalRotation});\n    let transform = scalePage(pageNumber, viewport, canvasContext);\n\n    // Render the page\n    return Promise.all([\n      pdfPage.render({ canvasContext, viewport, transform }).promise,\n      PDFJSAnnotate.render(svg, viewport, annotations)\n    ]).then(() => {\n      // Text content is needed for a11y, but is also necessary for creating\n      // highlight and strikeout annotations which require selecting text.\n      return pdfPage.getTextContent({normalizeWhitespace: true}).then((textContent) => {\n        return new Promise((resolve, reject) => {\n          // Render text layer for a11y of text content\n          let eventBus = getGlobalEventBus();\n          let textLayer = page.querySelector(config.textClassQuery());\n          let textLayerFactory = new pdfjsViewer.DefaultTextLayerFactory();\n          let textLayerBuilder = textLayerFactory.createTextLayerBuilder(textLayer, pageNumber - 1, viewport, true, eventBus);\n          textLayerBuilder.setTextContent(textContent);\n          textLayerBuilder.render();\n\n          // Enable a11y for annotations\n          // Timeout is needed to wait for `textLayerBuilder.render`\n          setTimeout(() => {\n            try {\n              renderScreenReaderHints(annotations.annotations);\n              resolve();\n            }\n            catch (e) {\n              reject(e);\n            }\n          });\n        });\n      });\n    }).then(() => {\n      // Indicate that the page was loaded\n      page.setAttribute('data-loaded', 'true');\n\n      return [pdfPage, annotations];\n    });\n  });\n}\n\n/**\n * Only rerender a page (SVG layer) that has annotations updated.\n *\n * @param {Number} pageNumber The page number to be rendered\n * @param {Object} renderOptions The options for rendering\n * @return {Promise} Settled once rendering has completed\n *  A settled Promise will be either:\n *    - fulfilled: [pdfPage, annotations]\n *    - rejected: Error\n */\nexport function rerenderAnnotations(pageNumber, renderOptions) {\n  let {\n    documentId,\n    pdfDocument,\n    scale,\n    rotate\n  } = renderOptions;\n\n  // Load the page and annotations\n  return Promise.all([\n    pdfDocument.getPage(pageNumber),\n    PDFJSAnnotate.getAnnotations(documentId, pageNumber)\n  ]).then(([pdfPage, annotations]) => {\n    let page = document.getElementById(`pageContainer${pageNumber}`);\n    let svg = page.querySelector(config.annotationClassQuery());\n    let totalRotation = (rotate + pdfPage.rotate) % 360;\n    let viewport = pdfPage.getViewport({scale: scale, rotation: totalRotation});\n\n    // Render the SVG\n    return Promise.all([\n      PDFJSAnnotate.render(svg, viewport, annotations)\n    ]).then(() => {\n\n    }).then(() => {\n      return [pdfPage, annotations];\n    });\n  });\n}\n\n/**\n * Scale the elements of a page.\n *\n * @param {Number} pageNumber The page number to be scaled\n * @param {Object} viewport The viewport of the PDF page (see pdfPage.getViewport(scale, rotate))\n * @param {Object} context The canvas context that the PDF page is rendered to\n * @return {Array} The transform data for rendering the PDF page\n */\nfunction scalePage(pageNumber, viewport, context) {\n  let page = document.getElementById(`pageContainer${pageNumber}`);\n  let canvas = page.querySelector('.canvasWrapper canvas');\n  let svg = page.querySelector(config.annotationClassQuery());\n  let wrapper = page.querySelector('.canvasWrapper');\n  let textLayer = page.querySelector(config.textClassQuery());\n  let outputScale = getOutputScale(context);\n  let transform = !outputScale.scaled ? null : [outputScale.sx, 0, 0, outputScale.sy, 0, 0];\n  let sfx = approximateFraction(outputScale.sx);\n  let sfy = approximateFraction(outputScale.sy);\n\n  // Adjust width/height for scale\n  page.style.visibility = '';\n  canvas.width = roundToDivide(viewport.width * outputScale.sx, sfx[0]);\n  canvas.height = roundToDivide(viewport.height * outputScale.sy, sfy[0]);\n  canvas.style.width = roundToDivide(viewport.width, sfx[1]) + 'px';\n  canvas.style.height = roundToDivide(viewport.height, sfx[1]) + 'px';\n  svg.setAttribute('width', viewport.width);\n  svg.setAttribute('height', viewport.height);\n  svg.style.width = `${viewport.width}px`;\n  svg.style.height = `${viewport.height}px`;\n  page.style.width = `${viewport.width}px`;\n  page.style.height = `${viewport.height}px`;\n  wrapper.style.width = `${viewport.width}px`;\n  wrapper.style.height = `${viewport.height}px`;\n  textLayer.style.width = `${viewport.width}px`;\n  textLayer.style.height = `${viewport.height}px`;\n\n  return transform;\n}\n\n/**\n * Approximates a float number as a fraction using Farey sequence (max order of 8).\n *\n * @param {Number} x Positive float number\n * @return {Array} Estimated fraction: the first array item is a numerator,\n *                 the second one is a denominator.\n */\nfunction approximateFraction(x) {\n  // Fast path for int numbers or their inversions.\n  if (Math.floor(x) === x) {\n    return [x, 1];\n  }\n\n  const xinv = 1 / x;\n  const limit = 8;\n  if (xinv > limit) {\n    return [1, limit];\n  }\n  else if (Math.floor(xinv) === xinv) {\n    return [1, xinv];\n  }\n\n  const x_ = x > 1 ? xinv : x;\n\n  // a/b and c/d are neighbours in Farey sequence.\n  let a = 0; let b = 1; let c = 1; let d = 1;\n\n  // Limit search to order 8.\n  while (true) {\n    // Generating next term in sequence (order of q).\n    let p = a + c; let q = b + d;\n    if (q > limit) {\n      break;\n    }\n    if (x_ <= p / q) {\n      c = p; d = q;\n    }\n    else {\n      a = p; b = q;\n    }\n  }\n\n  // Select closest of neighbours to x.\n  if (x_ - a / b < c / d - x_) {\n    return x_ === x ? [a, b] : [b, a];\n  }\n  else {\n    return x_ === x ? [c, d] : [d, c];\n  }\n}\n\nfunction getOutputScale(ctx) {\n  let devicePixelRatio = window.devicePixelRatio || 1;\n  let backingStoreRatio = ctx.webkitBackingStorePixelRatio ||\n                          ctx.mozBackingStorePixelRatio ||\n                          ctx.msBackingStorePixelRatio ||\n                          ctx.oBackingStorePixelRatio ||\n                          ctx.backingStorePixelRatio || 1;\n  let pixelRatio = devicePixelRatio / backingStoreRatio;\n  return {\n    sx: pixelRatio,\n    sy: pixelRatio,\n    scaled: pixelRatio !== 1\n  };\n}\n\nfunction roundToDivide(x, div) {\n  let r = x % div;\n  return r === 0 ? x : Math.round(x - r + div);\n}\n","import { addEventListener, removeEventListener, fireEvent, removeAllEventListener, enableUI, disableUI } from './event';\nimport { disableEdit, enableEdit, createEditOverlay, destroyEditOverlay } from './edit';\nimport { disablePen, enablePen, setPen } from './pen';\nimport { disableArrow, enableArrow, setArrow } from './arrow';\nimport { disableEraser, enableEraser } from './eraser';\nimport { disablePoint, enablePoint } from './point';\nimport { disableRect, enableRect } from './rect';\nimport { disableCircle, enableCircle, setCircle, addCircle } from './circle';\nimport { disableText, enableText, setText } from './text';\nimport { createPage, renderPage, rerenderAnnotations } from './page';\n\nexport default {\n  addEventListener,\n  removeEventListener,\n  fireEvent,\n  removeAllEventListener,\n  enableUI,\n  disableUI,\n\n  disableEdit,\n  enableEdit,\n  createEditOverlay,\n  destroyEditOverlay,\n\n  disablePen,\n  enablePen,\n  setPen,\n\n  disablePoint,\n  enablePoint,\n\n  disableRect,\n  enableRect,\n\n  disableCircle,\n  enableCircle,\n  setCircle,\n  addCircle,\n\n  disableArrow,\n  enableArrow,\n  setArrow,\n\n  disableEraser,\n  enableEraser,\n\n  disableText,\n  enableText,\n  setText,\n\n  createPage,\n  renderPage,\n  rerenderAnnotations\n};\n","import StoreAdapter from './adapter/StoreAdapter';\nimport LocalStoreAdapter from './adapter/LocalStoreAdapter';\nimport LocalUserStoreAdapter from './adapter/LocalUserStoreAdapter';\nimport render from './render';\nimport UI from './UI';\nimport config from './config';\nimport uuid from './utils/uuid';\nimport {\n  findAnnotationAtPoint,\n  findSVGContainer,\n  convertToScreenPoint\n} from './UI/utils';\n\nexport default {\n  findAnnotationAtPoint,\n  findSVGContainer,\n  convertToScreenPoint,\n\n  /**\n   * Abstract class that needs to be defined so PDFJSAnnotate\n   * knows how to communicate with your server.\n   */\n  StoreAdapter,\n\n  /**\n   * Implementation of StoreAdapter that stores annotation data to localStorage.\n   */\n  LocalStoreAdapter,\n\n  /**\n   * Implementation of StoreAdapter that stores annotation data to localStorage particular\n   * to a specific user\n   */\n  LocalUserStoreAdapter,\n\n  /**\n   * Abstract instance of StoreAdapter\n   */\n  __storeAdapter: new StoreAdapter(),\n\n  /**\n   * Getter for the underlying StoreAdapter property\n   *\n   * @return {StoreAdapter} The current StoreAdapter\n   */\n  getStoreAdapter() {\n    return this.__storeAdapter;\n  },\n\n  /**\n   * Setter for the underlying StoreAdapter property\n   *\n   * @param {StoreAdapter} adapter The StoreAdapter implementation to be used.\n   */\n  setStoreAdapter(adapter) {\n    // TODO this throws an error when bundled\n    // if (!(adapter instanceof StoreAdapter)) {\n    //   throw new Error('adapter must be an instance of StoreAdapter');\n    // }\n\n    this.__storeAdapter = adapter;\n  },\n\n  /**\n   * UI is a helper for instrumenting UI interactions for creating,\n   * editing, and deleting annotations in the browser.\n   */\n  UI,\n\n  /**\n   * Render the annotations for a page in the PDF Document\n   *\n   * @param {SVGElement} svg The SVG element that annotations should be rendered to\n   * @param {PageViewport} viewport The PDFPage.getViewport data\n   * @param {Object} data The StoreAdapter.getAnnotations data\n   * @return {Promise}\n   */\n  render,\n\n  /**\n   * Convenience method for getting annotation data\n   *\n   * @alias StoreAdapter.getAnnotations\n   * @param {String} documentId The ID of the document\n   * @param {String} pageNumber The page number\n   * @return {Promise} Promise that returns with list of annotations for document and page\n   */\n  getAnnotations(documentId, pageNumber) {\n    return this.getStoreAdapter().getAnnotations(...arguments);\n  },\n\n  config,\n\n  uuid\n};\n","import { appendChild, transformChild } from './appendChild';\n\n/**\n * Render the response from PDFJSAnnotate.getStoreAdapter().getAnnotations to SVG\n *\n * @param {SVGElement} svg The SVG element to render the annotations to\n * @param {Object} viewport The page viewport data\n * @param {Object} data The response from PDFJSAnnotate.getStoreAdapter().getAnnotations\n * @return {Promise} Settled once rendering has completed\n *  A settled Promise will be either:\n *    - fulfilled: SVGElement\n *    - rejected: Error\n */\nexport default function render(svg, viewport, data) {\n  return new Promise((resolve, reject) => {\n    // Reset the content of the SVG\n    svg.innerHTML = '';\n    svg.setAttribute('data-pdf-annotate-container', true);\n    svg.setAttribute('data-pdf-annotate-viewport', JSON.stringify(viewport));\n    svg.removeAttribute('data-pdf-annotate-document');\n    svg.removeAttribute('data-pdf-annotate-page');\n\n    // If there's no data nothing can be done\n    if (!data) {\n      svg.innerHTML = '';\n      return resolve(svg);\n    }\n\n    svg.setAttribute('data-pdf-annotate-document', data.documentId);\n    svg.setAttribute('data-pdf-annotate-page', data.pageNumber);\n\n    // Make sure annotations is an array\n    if (!Array.isArray(data.annotations) || data.annotations.length === 0) {\n      return resolve(svg);\n    }\n\n    // Append or transform annotation to svg\n    data.annotations.forEach((a) => {\n      let node = svg.querySelector('[data-pdf-annotate-id=\"' + a.uuid + '\"]');\n      if (node) {\n        transformChild(svg, node, viewport);\n      }\n      else {\n        appendChild(svg, a, viewport);\n      }\n    });\n\n    resolve(svg);\n  });\n}\n","import PDFJSAnnotate from './src/PDFJSAnnotate';\n\nexport default PDFJSAnnotate;\n","// Color picker component\nconst COLORS = [\n  {hex: '#000000', name: 'Black'},\n  {hex: '#EF4437', name: 'Red'},\n  {hex: '#E71F63', name: 'Pink'},\n  {hex: '#8F3E97', name: 'Purple'},\n  {hex: '#65499D', name: 'Deep Purple'},\n  {hex: '#4554A4', name: 'Indigo'},\n  {hex: '#2083C5', name: 'Blue'},\n  {hex: '#35A4DC', name: 'Light Blue'},\n  {hex: '#09BCD3', name: 'Cyan'},\n  {hex: '#009688', name: 'Teal'},\n  {hex: '#43A047', name: 'Green'},\n  {hex: '#8BC34A', name: 'Light Green'},\n  {hex: '#FDC010', name: 'Yellow'},\n  {hex: '#F8971C', name: 'Orange'},\n  {hex: '#F0592B', name: 'Deep Orange'},\n  {hex: '#F06291', name: 'Light Pink'}\n];\n\nexport default function initColorPicker(el, value, onChange) {\n  function getNameFromHex(hex) {\n    for (let color of COLORS) {\n      if (color.hex === hex) {\n        return color.name;\n      }\n    }\n  }\n\n  function setColor(hex, name, fireOnChange = true) {\n    a.setAttribute('data-color', hex);\n    a.setAttribute('data-name', name);\n    a.setAttribute('title', name);\n    a.style.background = hex;\n    if (fireOnChange && typeof onChange === 'function') {\n      onChange(hex);\n    }\n    closePicker();\n  }\n\n  function togglePicker() {\n    if (isPickerOpen) {\n      closePicker();\n    }\n    else {\n      openPicker();\n    }\n  }\n\n  function closePicker() {\n    document.removeEventListener('keyup', handleDocumentKeyup);\n    if (picker && picker.parentNode) {\n      picker.parentNode.removeChild(picker);\n    }\n    isPickerOpen = false;\n    a.focus();\n  }\n\n  function openPicker() {\n    if (!picker) {\n      picker = document.createElement('div');\n      picker.style.background = '#fff';\n      picker.style.border = '1px solid #ccc';\n      picker.style.padding = '2px';\n      picker.style.position = 'absolute';\n      picker.style.width = '122px';\n      el.style.position = 'relative';\n\n      COLORS.map(createColorOption).forEach((c) => {\n        c.style.margin = '2px';\n        c.onclick = function() {\n          setColor(c.getAttribute('data-color'), c.getAttribute('data-name'));\n        };\n        picker.appendChild(c);\n      });\n    }\n\n    document.addEventListener('keyup', handleDocumentKeyup);\n    el.appendChild(picker);\n    isPickerOpen = true;\n  }\n\n  function createColorOption(color) {\n    let e = document.createElement('a');\n    e.className = 'color';\n    e.setAttribute('href', 'javascript://');\n    e.setAttribute('title', color.name);\n    e.setAttribute('data-name', color.name);\n    e.setAttribute('data-color', color.hex);\n    e.style.background = color.hex;\n    return e;\n  }\n\n  function handleDocumentKeyup(e) {\n    if (e.keyCode === 27) {\n      closePicker();\n    }\n  }\n\n  let picker;\n  let isPickerOpen = false;\n  let name = getNameFromHex(value);\n  let a = createColorOption({hex: value, name: name});\n  a.onclick = togglePicker;\n  el.appendChild(a);\n  setColor(value, name, false);\n}\n","import PDFJSAnnotate from '../';\nimport initColorPicker from './shared/initColorPicker';\n\nfunction htmlEscape(text) {\n  return text\n    .replace('&', '&amp;')\n    .replace('>', '&gt;')\n    .replace('<', '&lt;')\n    .replace('\"', '&quot;')\n    .replace(\"'\", '&#39;');\n}\n\nconst { UI } = PDFJSAnnotate;\nconst documentId = 'example.pdf';\nlet PAGE_HEIGHT;\nlet RENDER_OPTIONS = {\n  documentId: documentId,\n  pdfDocument: null,\n  scale: parseFloat(localStorage.getItem(`${documentId}/scale`), 10) || 1.33,\n  rotate: parseInt(localStorage.getItem(`${documentId}/rotate`), 10) || 0\n};\n\nPDFJSAnnotate.setStoreAdapter(new PDFJSAnnotate.LocalStoreAdapter());\npdfjsLib.workerSrc = './shared/pdf.worker.js';\n\n// Render stuff\nlet NUM_PAGES = 0;\nlet renderedPages = [];\nlet okToRender = false;\ndocument.getElementById('content-wrapper').addEventListener('scroll', (e) => {\n  let visiblePageNum = Math.round(e.target.scrollTop / PAGE_HEIGHT) + 1;\n  let visiblePage = document.querySelector(`.page[data-page-number=\"${visiblePageNum}\"][data-loaded=\"false\"]`);\n\n  if (renderedPages.indexOf(visiblePageNum) === -1) {\n    okToRender = true;\n    renderedPages.push(visiblePageNum);\n  }\n  else {\n    okToRender = false;\n  }\n\n  if (visiblePage && okToRender) {\n    setTimeout(() => {\n      UI.renderPage(visiblePageNum, RENDER_OPTIONS);\n    });\n  }\n});\n\nfunction render() {\n  const loadingTask = pdfjsLib.getDocument({\n    url: RENDER_OPTIONS.documentId,\n    cMapUrl: 'shared/cmaps/',\n    cMapPacked: true\n  });\n\n  loadingTask.promise.then((pdf) => {\n    RENDER_OPTIONS.pdfDocument = pdf;\n\n    let viewer = document.getElementById('viewer');\n    viewer.innerHTML = '';\n    NUM_PAGES = pdf.numPages;\n    for (let i = 0; i < NUM_PAGES; i++) {\n      let page = UI.createPage(i + 1);\n      viewer.appendChild(page);\n    }\n\n    UI.renderPage(1, RENDER_OPTIONS).then(([pdfPage, annotations]) => {\n      let viewport = pdfPage.getViewport({ scale: RENDER_OPTIONS.scale, rotation: RENDER_OPTIONS.rotate });\n      PAGE_HEIGHT = viewport.height;\n    });\n  });\n}\nrender();\n\n// Hotspot color stuff\n// (function() {\n//   let hotspotColor = localStorage.getItem(`${RENDER_OPTIONS.documentId}/hotspot/color`) || 'darkgoldenrod';\n//   let currentTarget;\n\n//   function handleAnnotationClick(target) {\n//     let type = target.getAttribute('data-pdf-annotate-type');\n//     if (['fillcircle', 'arrow'].indexOf(type) === -1) {\n//       return; // nothing to do\n//     }\n//     currentTarget = target;\n//     hotspotColor = currentTarget.getAttribute('stroke');\n\n//     UI.setArrow(10, hotspotColor);\n//     UI.setCircle(10, hotspotColor);\n\n//     let a = document.querySelector('.hotspot-color .color');\n//     if (a) {\n//       a.setAttribute('data-color', hotspotColor);\n//       a.style.background = hotspotColor;\n//     }\n//   }\n\n//   function handleAnnotationBlur(target) {\n//     if (currentTarget === target) {\n//       currentTarget = undefined;\n//     }\n//   }\n\n//   // initColorPicker(document.querySelector('.hotspot-color'), hotspotColor, function(value) {\n//   //   if (value === hotspotColor) {\n//   //     return; // nothing to do\n//   //   }\n//   //   localStorage.setItem(`${RENDER_OPTIONS.documentId}/hotspot/color`, value);\n//   //   hotspotColor = value;\n\n//   //   UI.setArrow(10, hotspotColor);\n//   //   UI.setCircle(10, hotspotColor);\n\n//   //   if (!currentTarget) {\n//   //     return; // nothing to do\n//   //   }\n\n//   //   let type = currentTarget.getAttribute('data-pdf-annotate-type');\n//   //   let annotationId = currentTarget.getAttribute('data-pdf-annotate-id');\n//   //   if (['fillcircle', 'arrow'].indexOf(type) === -1) {\n//   //     return; // nothing to do\n//   //   }\n\n//   //   // update target\n//   //   currentTarget.setAttribute('stroke', hotspotColor);\n//   //   currentTarget.setAttribute('fill', hotspotColor);\n\n//   //   // update annotation\n//   //   PDFJSAnnotate.getStoreAdapter().getAnnotation(documentId, annotationId).then((annotation) => {\n//   //     annotation.color = hotspotColor;\n//   //     PDFJSAnnotate.getStoreAdapter().editAnnotation(documentId, annotationId, annotation);\n//   //   });\n//   // });\n\n//   UI.addEventListener('annotation:click', handleAnnotationClick);\n//   UI.addEventListener('annotation:blur', handleAnnotationBlur);\n// })();\n\n// Text stuff\n(function() {\n  let textSize;\n  let textColor;\n\n  function initText() {\n    let size = document.querySelector('.toolbar .text-size');\n    [8, 9, 10, 11, 12, 14, 18, 24, 30, 36, 48, 60, 72, 96].forEach((s) => {\n      size.appendChild(new Option(s, s));\n    });\n\n    setText(\n      localStorage.getItem(`${RENDER_OPTIONS.documentId}/text/size`) || 10,\n      localStorage.getItem(`${RENDER_OPTIONS.documentId}/text/color`) || '#000000'\n    );\n\n    initColorPicker(document.querySelector('.text-color'), textColor, function(value) {\n      setText(textSize, value);\n    });\n  }\n\n  function setText(size, color) {\n    let modified = false;\n\n    if (textSize !== size) {\n      modified = true;\n      textSize = size;\n      localStorage.setItem(`${RENDER_OPTIONS.documentId}/text/size`, textSize);\n      document.querySelector('.toolbar .text-size').value = textSize;\n    }\n\n    if (textColor !== color) {\n      modified = true;\n      textColor = color;\n      localStorage.setItem(`${RENDER_OPTIONS.documentId}/text/color`, textColor);\n\n      let selected = document.querySelector('.toolbar .text-color.color-selected');\n      if (selected) {\n        selected.classList.remove('color-selected');\n        selected.removeAttribute('aria-selected');\n      }\n\n      selected = document.querySelector(`.toolbar .text-color[data-color=\"${color}\"]`);\n      if (selected) {\n        selected.classList.add('color-selected');\n        selected.setAttribute('aria-selected', true);\n      }\n    }\n\n    if (modified) {\n      UI.setText(textSize, textColor);\n    }\n  }\n\n  function handleTextSizeChange(e) {\n    setText(e.target.value, textColor);\n  }\n\n  document.querySelector('.toolbar .text-size').addEventListener('change', handleTextSizeChange);\n\n  initText();\n})();\n\n// Pen stuff\n(function() {\n  let penSize;\n  let penColor;\n\n  function initPen() {\n    let size = document.querySelector('.toolbar .pen-size');\n    for (let i = 0; i < 20; i++) {\n      size.appendChild(new Option(i + 1, i + 1));\n    }\n\n    setPen(\n      localStorage.getItem(`${RENDER_OPTIONS.documentId}/pen/size`) || 1,\n      localStorage.getItem(`${RENDER_OPTIONS.documentId}/pen/color`) || '#000000'\n    );\n\n    initColorPicker(document.querySelector('.pen-color'), penColor, function(value) {\n      setPen(penSize, value);\n    });\n  }\n\n  function setPen(size, color) {\n    let modified = false;\n\n    if (penSize !== size) {\n      modified = true;\n      penSize = size;\n      localStorage.setItem(`${RENDER_OPTIONS.documentId}/pen/size`, penSize);\n      document.querySelector('.toolbar .pen-size').value = penSize;\n    }\n\n    if (penColor !== color) {\n      modified = true;\n      penColor = color;\n      localStorage.setItem(`${RENDER_OPTIONS.documentId}/pen/color`, penColor);\n\n      let selected = document.querySelector('.toolbar .pen-color.color-selected');\n      if (selected) {\n        selected.classList.remove('color-selected');\n        selected.removeAttribute('aria-selected');\n      }\n\n      selected = document.querySelector(`.toolbar .pen-color[data-color=\"${color}\"]`);\n      if (selected) {\n        selected.classList.add('color-selected');\n        selected.setAttribute('aria-selected', true);\n      }\n    }\n\n    if (modified) {\n      UI.setPen(penSize, penColor);\n    }\n  }\n\n  function handlePenSizeChange(e) {\n    setPen(e.target.value, penColor);\n  }\n\n  document.querySelector('.toolbar .pen-size').addEventListener('change', handlePenSizeChange);\n\n  initPen();\n})();\n\n// Toolbar buttons\n(function() {\n  let tooltype = localStorage.getItem(`${RENDER_OPTIONS.documentId}/tooltype`) || 'cursor';\n  if (tooltype) {\n    setActiveToolbarItem(tooltype, document.querySelector(`.toolbar button[data-tooltype=${tooltype}]`));\n  }\n\n  function setActiveToolbarItem(type, button) {\n    let active = document.querySelector('.toolbar button.active');\n    if (active) {\n      active.classList.remove('active');\n\n      switch (tooltype) {\n        case 'cursor':\n          UI.disableEdit();\n          break;\n        case 'eraser':\n          UI.disableEraser();\n          break;\n        case 'draw':\n          UI.disablePen();\n          break;\n        case 'arrow':\n          UI.disableArrow();\n          break;\n        case 'text':\n          UI.disableText();\n          break;\n        case 'point':\n          UI.disablePoint();\n          break;\n        case 'area':\n        case 'highlight':\n        case 'strikeout':\n          UI.disableRect();\n          break;\n        case 'circle':\n        case 'emptycircle':\n        case 'fillcircle':\n          UI.disableCircle();\n          break;\n        case 'select':\n          UI.enableUI();\n          break;\n      }\n    }\n\n    if (button) {\n      button.classList.add('active');\n    }\n    if (tooltype !== type) {\n      localStorage.setItem(`${RENDER_OPTIONS.documentId}/tooltype`, type);\n    }\n    tooltype = type;\n\n    switch (type) {\n      case 'cursor':\n        UI.enableEdit();\n        break;\n      case 'eraser':\n        UI.enableEraser();\n        break;\n      case 'draw':\n        UI.enablePen();\n        break;\n      case 'arrow':\n        UI.enableArrow();\n        break;\n      case 'text':\n        UI.enableText();\n        break;\n      case 'point':\n        UI.enablePoint();\n        break;\n      case 'area':\n      case 'highlight':\n      case 'strikeout':\n        UI.enableRect(type);\n        break;\n      case 'circle':\n      case 'emptycircle':\n      case 'fillcircle':\n        UI.enableCircle(type);\n        break;\n      case 'select':\n        UI.disableUI();\n    }\n  }\n\n  function handleToolbarClick(e) {\n    if (e.target.nodeName === 'BUTTON') {\n      setActiveToolbarItem(e.target.getAttribute('data-tooltype'), e.target);\n    }\n  }\n\n  document.querySelector('.toolbar').addEventListener('click', handleToolbarClick);\n})();\n\n// Scale/rotate\n(function() {\n  function setScaleRotate(scale, rotate) {\n    scale = parseFloat(scale, 10);\n    rotate = parseInt(rotate, 10);\n\n    if (RENDER_OPTIONS.scale !== scale || RENDER_OPTIONS.rotate !== rotate) {\n      RENDER_OPTIONS.scale = scale;\n      RENDER_OPTIONS.rotate = rotate;\n\n      localStorage.setItem(`${RENDER_OPTIONS.documentId}/scale`, RENDER_OPTIONS.scale);\n      localStorage.setItem(`${RENDER_OPTIONS.documentId}/rotate`, RENDER_OPTIONS.rotate % 360);\n\n      render();\n    }\n  }\n\n  function handleScaleChange(e) {\n    setScaleRotate(e.target.value, RENDER_OPTIONS.rotate);\n  }\n\n  // function handleRotateCWClick() {\n  //   console.warn('Rotate No tested!');\n  //   setScaleRotate(RENDER_OPTIONS.scale, RENDER_OPTIONS.rotate + 90);\n  // }\n\n  // function handleRotateCCWClick() {\n  //   console.warn('Rotate No tested!');\n  //   setScaleRotate(RENDER_OPTIONS.scale, RENDER_OPTIONS.rotate - 90);\n  // }\n\n  document.querySelector('.toolbar select.scale').value = RENDER_OPTIONS.scale;\n  document.querySelector('.toolbar select.scale').addEventListener('change', handleScaleChange);\n  // document.querySelector('.toolbar .rotate-ccw').addEventListener('click', handleRotateCCWClick);\n  // document.querySelector('.toolbar .rotate-cw').addEventListener('click', handleRotateCWClick);\n})();\n\n// Clear toolbar button\n(function() {\n  function handleClearClick(e) {\n    if (window.confirm('Are you sure you want to clear annotations?')) {\n      for (let i = 0; i < NUM_PAGES; i++) {\n        document.querySelector(`div#pageContainer${i + 1} svg.annotationLayer`).innerHTML = '';\n      }\n\n      localStorage.removeItem(`${RENDER_OPTIONS.documentId}/annotations`);\n      PDFJSAnnotate.getStoreAdapter().clearHistory(RENDER_OPTIONS.documentId);\n    }\n  }\n  document.querySelector('a.clear').addEventListener('click', handleClearClick);\n})();\n\n(function() {\n  function handleHistory(e) {\n    let type = e.target.getAttribute('data-tooltype');\n    if (type === 'undo') {\n      PDFJSAnnotate.getStoreAdapter().undo(RENDER_OPTIONS.documentId).then(() => {\n        for (let i = 1; i <= NUM_PAGES; i += 1) {\n          UI.rerenderAnnotations(i, RENDER_OPTIONS);\n        }\n      });\n    }\n    else if (type === 'redo') {\n      PDFJSAnnotate.getStoreAdapter().redo(RENDER_OPTIONS.documentId).then(() => {\n        for (let i = 1; i <= NUM_PAGES; i += 1) {\n          UI.rerenderAnnotations(i, RENDER_OPTIONS);\n        }\n      });\n    }\n    else if (type === 'clear_history') {\n      if (window.confirm('Clear history? This operation cannot be undone.')) {\n        PDFJSAnnotate.getStoreAdapter().clearHistory(RENDER_OPTIONS.documentId);\n      }\n    }\n  }\n\n  document.querySelector('a.undo').addEventListener('click', handleHistory);\n  document.querySelector('a.redo').addEventListener('click', handleHistory);\n  // document.querySelector('a.clear_history').addEventListener('click', handleHistory);\n})();\n\n// Comment stuff\n(function(window, document) {\n  let commentList = document.querySelector('#comment-wrapper .comment-list-container');\n  let commentForm = document.querySelector('#comment-wrapper .comment-list-form');\n  let commentText = commentForm.querySelector('input[type=\"text\"]');\n\n  function supportsComments(target) {\n    let type = target.getAttribute('data-pdf-annotate-type');\n    return ['point', 'highlight', 'area'].indexOf(type) > -1;\n  }\n\n  function insertComment(comment) {\n    let child = document.createElement('div');\n    child.className = 'comment-list-item';\n    child.innerHTML = htmlEscape(comment.content);\n\n    commentList.appendChild(child);\n  }\n\n  function handleAnnotationClick(target) {\n    if (supportsComments(target)) {\n      let documentId = target.parentNode.getAttribute('data-pdf-annotate-document');\n      let annotationId = target.getAttribute('data-pdf-annotate-id');\n\n      PDFJSAnnotate.getStoreAdapter().getComments(documentId, annotationId).then((comments) => {\n        commentList.innerHTML = '';\n        commentForm.style.display = '';\n        commentText.focus();\n\n        commentForm.onsubmit = function() {\n          PDFJSAnnotate.getStoreAdapter().addComment(documentId, annotationId, commentText.value.trim())\n            .then(insertComment)\n            .then(() => {\n              commentText.value = '';\n              commentText.focus();\n            });\n\n          return false;\n        };\n\n        comments.forEach(insertComment);\n      });\n    }\n  }\n\n  function handleAnnotationBlur(target) {\n    if (supportsComments(target)) {\n      commentList.innerHTML = '';\n      commentForm.style.display = 'none';\n      commentForm.onsubmit = null;\n\n      insertComment({ content: 'No comments' });\n    }\n  }\n\n  UI.addEventListener('annotation:click', handleAnnotationClick);\n  UI.addEventListener('annotation:blur', handleAnnotationBlur);\n\n  UI.setArrow(10, 'darkgoldenrod');\n  UI.setCircle(10, 'darkgoldenrod');\n})(window, document);\n"],"names":["root","factory","exports","module","define","amd","self","ReflectOwnKeys","R","Reflect","ReflectApply","apply","target","receiver","args","Function","prototype","call","ownKeys","Object","getOwnPropertySymbols","getOwnPropertyNames","concat","NumberIsNaN","Number","isNaN","value","EventEmitter","init","this","once","emitter","name","Promise","resolve","reject","errorListener","err","removeListener","resolver","slice","arguments","eventTargetAgnosticAddListener","handler","flags","on","addErrorHandlerIfEventEmitter","_events","undefined","_eventsCount","_maxListeners","defaultMaxListeners","checkListener","listener","TypeError","_getMaxListeners","that","_addListener","type","prepend","m","events","existing","warning","create","newListener","emit","unshift","push","length","warned","w","Error","String","count","console","warn","onceWrapper","fired","wrapFn","_onceWrap","state","wrapped","bind","_listeners","unwrap","evlistener","arr","ret","Array","i","unwrapListeners","arrayClone","listenerCount","n","copy","addEventListener","wrapListener","arg","removeEventListener","defineProperty","enumerable","get","set","RangeError","getPrototypeOf","setMaxListeners","getMaxListeners","doError","error","er","message","context","len","listeners","addListener","prependListener","prependOnceListener","list","position","originalListener","shift","index","pop","spliceOne","off","removeAllListeners","key","keys","rawListeners","eventNames","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","getter","__esModule","d","a","definition","o","obj","prop","hasOwnProperty","r","Symbol","toStringTag","abstractFunction","UPPER_REGEX","BLACKLIST","setAttributes","node","attributes","forEach","setAttribute","indexOf","replace","match","toLowerCase","keyCase","REGEX_HASHLESS_HEX","normalizeColor","color","test","SIZE","createRect","rect","document","createElementNS","x","y","width","height","renderText","text","fill","fontSize","size","transform","rotation","style","textElement","textContent","lines","split","getAttribute","line","tspan","toString","innerHTML","appendChild","insertLineBreaks","content","g","translate","rotate","angle","Math","PI","cosValue","cos","sinValue","sin","scale","makePoint","z","makeVector","xcoord","ycoord","zcoord","makeVectorFromPoints","pt1","pt2","addVector","pt","v","multiplyVector","scalar","magnitude","sqrt","pow","negateVector","unitVector","mag","isFirefox","navigator","userAgent","getTranslation","viewport","trans","nodeName","parseInt","path","querySelector","svg","parentNode","assign","annotation","child","group","JSON","parse","fillOpacity","rectangles","stroke","renderRect","circle","cx","cy","createCircle","renderCircle","strokeWidth","x1","y1","x2","y2","outerSVG","innerSVG","viewBox","renderPoint","l","p1","join","renderPath","u","arrow","p2","pt0","unitX","unitY","thickness","A","B","C","D","G","F","E","points","renderArrow","uuid","filter","BORDER_COLOR","userSelectStyleSheet","createElement","findSVGContainer","toUpperCase","isInForbiddenArea","pointElements","elementsFromPoint","classList","contains","findSVGAtPoint","elements","querySelectorAll","el","pointIntersectsRect","getBoundingClientRect","findAnnotationAtPoint","getOffsetAnnotationRect","top","bottom","left","right","offset","extraOffsetWidth","extraOffsetHeight","tagName","getBBox","bbox","getOffset","offsetLeft","offsetTop","scaleUp","result","getMetadata","convertToSvgPoint","xform","p","convertToScreenPoint","scaleDown","disableUserSelect","head","enableUserSelect","removeChild","documentId","pageNumber","clickNode","_enabled","fireEvent","e","clientX","clientY","StoreAdapter","history","__getAllAnnotations","fn","then","annotations","__getAnnotations","annotationId","__addAnnotation","__editAnnotation","__deleteAnnotation","success","__addComment","comment","commentId","__deleteComment","__undo","__redo","__clearHistory","REGEXP","replacement","c","random","LocalStoreAdapter","getAnnotations","page","getAnnotation","findAnnotation","addAnnotation","updateAnnotations","editAnnotation","deleteAnnotation","splice","getComments","addComment","class","deleteComment","getAllAnnotations","undo","idx","log","redo","clearHistory","historyStatus","clear","json","localStorage","getItem","setItem","stringify","LocalUserStoreAdapter","userId","globalEdit","_userId","_globalEdit","all_annotations","re","RegExp","search","_","annotationLayerName","textLayerName","annotationSvgQuery","annotationClassQuery","textClassQuery","overlay","dragOffsetX","dragOffsetY","dragStartX","dragStartY","isDragging","createEditOverlay","destroyEditOverlay","anchor","id","styleLeft","styleTop","boxSizing","border","borderRadius","zIndex","background","padding","textAlign","textDecoration","handleDocumentClick","handleDocumentKeyup","handleDocumentMousedown","borderColor","boxShadow","display","handleDocumentMousemove","handleDocumentMouseup","config","PDFJSAnnotate","getStoreAdapter","getElementById","keyTest","keyCode","preventDefault","cursor","maxY","maxX","offsetHeight","offsetWidth","attribX","attribY","t","moveTo","scaled_pos","modelStart","modelEnd","modelDelta","firstChild","modelX","modelY","parseFloat","setTimeout","handleAnnotationClick","_penSize","_penColor","_candraw","handleDocumentPointerdown","handleDocumentPointerup","saveToStorage","handleDocumentPointermove","point","toFixed","savePoint","originY","originX","_canerase","previousPoint","handleDocumentDown","handleDocumentUp","erase","handleDocumentMouseMove","check","diffX","abs","diffY","maxSteps","round","max","subStepSize","min","smallerTest","startPoint","parentElement","input","handleInputBlur","handleInputKeyup","body","focus","closeInput","trim","_type","rects","window","getSelection","getRangeAt","getClientRects","getSelectionRects","saveRect","map","removeAllRanges","boundingRect","convertToSvgRect","_circleRadius","_circleColor","radius","svg_pt","saveCircle","_textSize","_textColor","saveText","shiftKey","createScreenReaderOnly","createTextNode","overflow","insertElementWithinElement","insertBefore","textLayerElementFromPoint","temp","cloneNode","tail","outerHTML","insertElementWithinChildren","nodes","textLayer","insertScreenReaderComment","item","renderScreenReaderComments","comments","isArray","COMMENT_TYPES","reorderAnnotationsByType","removeAnnotation","renderScreenReaderHints","removeElementById","elementId","SORT_TYPES","sortBy","sort","num","first","last","includes","insertScreenReaderHint","sortByPoint","b","sortByRectPoint","lineA","lineB","PAGE_TEMPLATE","eventBus","getGlobalEventBus","dispatchToDOM","pdfjsViewer","EventBus","approximateFraction","floor","xinv","x_","q","roundToDivide","div","removeAllEventListener","enableUI","disableUI","disableEdit","enableEdit","disablePen","enablePen","setPen","penSize","penColor","disablePoint","enablePoint","disableRect","enableRect","disableCircle","enableCircle","setCircle","circleRadius","circleColor","addCircle","oldType","disableArrow","enableArrow","setArrow","disableEraser","enableEraser","disableText","enableText","setText","textSize","textColor","createPage","children","canvas","mozOpaque","renderPage","renderOptions","pdfDocument","all","getPage","pdfPage","canvasContext","getContext","alpha","totalRotation","getViewport","ctx","pixelRatio","wrapper","outputScale","sx","devicePixelRatio","webkitBackingStorePixelRatio","mozBackingStorePixelRatio","msBackingStorePixelRatio","oBackingStorePixelRatio","backingStorePixelRatio","sy","scaled","sfx","sfy","visibility","scalePage","render","promise","getTextContent","normalizeWhitespace","textLayerBuilder","DefaultTextLayerFactory","createTextLayerBuilder","setTextContent","rerenderAnnotations","__storeAdapter","setStoreAdapter","adapter","UI","data","removeAttribute","transformChild","COLORS","hex","initColorPicker","onChange","setColor","fireOnChange","closePicker","picker","isPickerOpen","createColorOption","className","getNameFromHex","onclick","margin","PAGE_HEIGHT","RENDER_OPTIONS","pdfjsLib","workerSrc","NUM_PAGES","renderedPages","okToRender","getDocument","url","cMapUrl","cMapPacked","pdf","viewer","numPages","visiblePageNum","scrollTop","visiblePage","modified","selected","remove","add","s","Option","initPen","tooltype","setActiveToolbarItem","button","active","setScaleRotate","confirm","removeItem","handleHistory","commentList","commentForm","commentText","supportsComments","insertComment","onsubmit"],"sourceRoot":""}